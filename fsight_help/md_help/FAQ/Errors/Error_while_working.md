# Проблемы при работе

Проблемы при работе
-


# Проблемы при работе


При работе с «Форсайт. Аналитическая платформа»
 в отдельных случаях могут возникать различные проблемы. Ниже описаны наиболее
 распространенные из них, а также причины их появления и пути решения:


[![](../opened.gif)![](../closed.gif)Аварийное
 завершение приложения при активированных замерах производительности
 ](javascript:TextPopup(this))


	Проблема


	Процесс BI-сервера аварийно завершается при активированных замерах
	 производительности.


	Причина


	Аварийное завершение происходит по причине срабатывания защиты от
	 выполнения данных (DEP). При замерах потребления памяти осуществляется
	 перехват вызова функций выделения/освобождения памяти. Для этого выполняется
	 запись байтов исполняемого кода в память, что приводит к срабатыванию
	 защиты.


	Решение


	Замеры памяти будут работать только при выключенной защите от выполнения
	 данных. Выключение осуществляется следующим образом:


		- в панели управления выберите
		 «Система/Дополнительные параметры
		 системы»;


		- на вкладке «Дополнительно»
		 в разделе «Быстродействие»
		 нажмите кнопку «Параметры»;


		- на вкладке «Предотвращение
		 выполнения данных» выберите флаг «Включить
		 DEP только основных программ и служб Windows» или добавьте
		 соответствующие исключения:


			- при использовании IIS: добавьте в исключения файл «w3wp.exe», расположенный
			 в каталоге «c:\Windows\System32\inetsrv\»;


			- при использовании веб-сервера Apache2: добавьте в исключения
			 файл «httpd.exe» из
			 каталога, куда установлен веб-сервер Apache2.


[![](../opened.gif)![](../closed.gif)Соединение
 разорвано администратором ](javascript:TextPopup(this))


	Проблема


	При работе с «Форсайт. Аналитическая платформа»
	 появляется следующее сообщение:


	Соединение разорвано
	 администратором.

	Обратитесь к администратору.


	Причина


	Эта проблема может возникнуть, если пользователь был отключен от
	 репозитория администратором.


	Решение


	Необходимо уточнить у администратора время, по истечении которого
	 можно продолжить работу с репозиторием. Для продолжения необходимо
	 будет переподключиться к репозиторию.


[![](../opened.gif)![](../closed.gif)Отсутствие
 соединения с сервером ](javascript:TextPopup(this))


	Проблема


	При работе с «Форсайт. Аналитическая платформа»
	 в веб-приложении или [конструкторе
	 бизнес-приложений](Constructor.chm::/Intro/Designer_business_applications.htm) возникает следующая ошибка:


	![](connection_error.png)


	Причина


	Соединение с сервером может быть разорвано, если отсутствует подключение
	 к сети Интернет и/или недоступен [BI-сервер](Setup.chm::/UiWebSetup/UiWebSetup_TitlePage.htm).


	Решение


	Для решения проблемы:


		- Не закрывайте вкладку браузера, если данные не сохранены.


		- Установите соединение с сетью Интернет и/или обеспечьте
		 доступ к BI-серверу. Для проверки работы BI-сервера обратитесь
		 к разделу «[Проверка
		 работы BI-сервера](Setup.chm::/UiWebSetup/01_BIServer/CheckBIServices.htm)».


		- Нажмите кнопку «Проверить
		 соединение».


	После выполнения действий будет выдано сообщение о статусе восстановления
	 соединения с сервером:


		- если соединение с сервером восстановлено, то продолжите
		 работу с «Форсайт. Аналитическая платформа»;


		- если за время отсутствия соединения с сервером [истекло
		 время жизни сессии](#7_4), то выполните повторную авторизацию и продолжите
		 работу с «Форсайт. Аналитическая платформа»;


		- если соединение с сервером не восстановлено, то обратитесь
		 к администратору.


[![](../opened.gif)![](../closed.gif)Истекло
 время жизни сессии ](javascript:TextPopup(this))


	Проблема


	При работе с «Форсайт. Аналитическая платформа»
	 в веб-приложении или [конструкторе
	 бизнес-приложений](Constructor.chm::/Intro/Designer_business_applications.htm) возникает следующая ошибка:


	![](session_time_error.png)


	Причина


	Время жизни сессии истекло.


	Решение


	Для решения проблемы выполните повторную авторизацию в [окне регистрации](getstarted.chm::/GetStarted/Get_Started.htm)
	 с помощью кнопки «Авторизоваться».
	 После успешной авторизации будет открыта текущая страница, на которой
	 возникла ошибка.


	Для получения подробной информации
	 о настройке таймаутов работы обратитесь к разделу «[Настройка
	 таймаутов работы](setup.chm::/UiWebSetup/03_Setup_Web/setting_the_timeout.htm)».


[![](../opened.gif)![](../closed.gif)Отказ
 в доступе при работе с репозиторием ](javascript:TextPopup(this))


	Проблема


	При создании, редактировании или удалении [настроек
	 подключения к репозиторию](Setup.chm::/06_AK_Client_Config/UiNav_RepoConfig_repo1.htm), предназначенному для
	 всех пользователей, пользователю было отказано в доступе.


	Примечание.
	 Репозиторий предназначен для всех пользователей, если установлен переключатель
	 «Для всех пользователей на компьютере»
	 в диалоге «[Параметры репозитория](Setup.chm::/06_AK_Client_Config/UiNav_RepoConfig_repo1.htm#param_repository)».


	Причина


	Проблема может возникнуть, если:


		- продукт «Форсайт. Аналитическая платформа»
		 запущен без повышения привилегий при включенном UAC;


		- у пользователя отсутствуют права на запись в реестр в ветку
		 HKEY_LOCAL_MACHINE.


	Решение


	Выполните вход в «Форсайт. Аналитическая платформа»
	 с правами администратора.


[![](../opened.gif)![](../closed.gif)Не
 сохраняются настройки репозитория ](javascript:TextPopup(this))


	Проблема


	При создании пользователем, не входящим в группу локальных администраторов,
	 [настроек
	 подключения к репозиторию](Setup.chm::/06_AK_Client_Config/UiNav_RepoConfig_repo1.htm), предназначенного для
	 текущего пользователя, после перезапуска «Форсайт. Аналитическая платформа»
	 настройки нового репозитория не будут сохранены.


	Причина


	При установке переключателя в положение «Для
	 текущего пользователя» происходит запись в реестр. Список добавленных
	 репозиториев будет пустой, так как нет возможности прочитать значения
	 реестра.


	Примечание. Репозиторий
	 предназначен для текущего пользователя, если установлен переключатель
	 «Для текущего пользователя»
	 в диалоге «[Параметры репозитория](Setup.chm::/06_AK_Client_Config/UiNav_RepoConfig_repo1.htm#param_repository)».


	Решение


	Для решения проблемы необходимо дать пользователю права на чтение
	 реестра.


[![](../opened.gif)![](../closed.gif)При
 запуске приложений Microsoft Office не появляется вкладка «Foresight»
 ](javascript:TextPopup(this))


	Проблема


	После установки надстроек Foresight
	 Add-In при запуске приложений Microsoft Office на ленте инструментов
	 не появляется вкладка «Foresight».


	Решение


		- Проверьте, совпадают ли разрядности установленного настольного
		 приложения «Форсайт. Аналитическая платформа»,
		 используемых приложений Microsoft Office и установленной надстройки
		 Foresight Add-In.
		 Для корректной работы все три разрядности должны совпадать. Если
		 разрядности не совпадают, приведите их в соответствие друг другу.
		 Чтобы изменения вступили в силу, перезапустите приложение Microsoft
		 Office.


		- Проверьте, совпадают ли версии установленного настольного
		 приложения «Форсайт. Аналитическая платформа»
		 и установленной надстройки Foresight
		 Add-In. Для корректной работы версии должны совпадать. Если версии
		 не совпадают, приведите их в соответствие друг другу. Чтобы изменения
		 вступили в силу, перезапустите приложение Microsoft Office.


		- Если вкладка «Foresight» не появилась,
		 перейдите в параметры документа и на вкладке «Надстройка»
		 в списке неактивных надстроек выберите «Foresight
		 Add-In». В раскрывающемся списке «Управление»
		 выберите «Надстройки COM»
		 и нажмите кнопку «Перейти».
		 Затем установите флажок напротив надстройки и нажмите кнопку «OK». Чтобы изменения вступили
		 в силу, перезапустите приложение Microsoft Office.


		- Добавьте местоположение надстройки в «Надежные
		 расположения». Для этого перейдите в параметры документа
		 и на вкладке «Центр управления
		 безопасностью» нажмите кнопку «Параметры
		 центра управления безопасностью». В открывшемся окне «Центр управления безопасностью»
		 перейдите на вкладку:


			- «Надежные
			 расположения». Добавьте в список «Расположения
			 пользователей» новое расположение, указав путь до установленного
			 продукта «Форсайт. Аналитическая платформа»,
			 например: C:\Program Files\Foresight\Analytics Platform
			 10.x\;


			- «Надстройки».
			 Проверьте, что на вкладке не установлены флажки ограничений
			 надстроек.


	Чтобы изменения вступили в силу, перезапустите
	 приложение Microsoft Office.


		- Убедитесь, что параметру LoadBehavior
		 установлено значение «3» в ветках реестра:


			- [HKEY_CURRENT_USER\Software\Microsoft\Office\Excel\Addins\Foresight.ExcelAddIn]
			 - подраздел для настроек текущего пользователя;


			- [HKEY_LOCAL_MACHINE\Software\Microsoft\Office\Excel\Addins\Foresight.ExcelAddIn]
			 - подраздел для настроек всех пользователей.


[![](../opened.gif)![](../closed.gif)На
 английской операционной системе при входе в репозиторий вместо русских
 наименований отображаются знаки вопроса ](javascript:TextPopup(this))


	Проблема


	Во время работы в английской операционной системе после подключения
	 к репозиторию наименования объектов, которые были заданы на русском
	 языке, отображаются в виде знаков вопроса «?».


	Причина


	Репозиторий был создан из-под русской операционной системы и для
	 него не был выставлен флажок «[Для
	 работы с набором символов Юникод](Setup.chm::/05_RepoMngr/Setup_RepoMngr_CreateRepo.htm)».


	Решение


	Данную проблему можно решить только путем пересоздания репозитория
	 с установленным флажком «[Для
	 работы с набором символов Юникод](Setup.chm::/05_RepoMngr/Setup_RepoMngr_CreateRepo.htm)».
	 Также для баз данных, которые содержат настройки репозитория, необходимо
	 установить флажок «[Использовать
	 кодировку юникод для представления данных](UiNavObj.chm::/database/UiDb_database_master_property.htm)».


[![](../opened.gif)![](../closed.gif)При
 подключении к СУБД репозитория возникает ошибка «ERROR: ORA-21561: OID
 generation failed» ](javascript:TextPopup(this))


	Проблема


	После установки BI-сервера «Форсайт. Аналитическая платформа»
	 в RedHat-подобном дистрибутиве при подключении к репозиторию на базе
	 СУБД Oracle возникает ошибка


	ERROR: ORA-21561:
	 OID generation failed.


	Причина


	Ошибка не связана с «Форсайт. Аналитическая платформа»,
	 причиной может быть содержимое файла hosts.


	Решение


	Для исправления ошибки выполните следующие действия:


		- Посмотрите IP-адрес компьютера (команда: ip
		 a) и сетевое имя компьютера (команда: hostname).


		- Добавьте сопоставление IP-адреса и сетевого имени в файл /etc/hosts.
		 Открывать файл на редактирование необходимо с правами администратора:


	sudo nano /etc/hosts


[![](../opened.gif)![](../closed.gif)При
 создании репозитория на сервере PostgreSQL появляется сообщение об ошибке
 ](javascript:TextPopup(this))


	Проблема


	После прохождения
	 процедуры подготовки сервера PostgreSQL, при создании репозитория
	 в менеджере репозитория появляется сообщение об ошибке.


	Причина


	Наиболее распространенные ошибки в работе с драйвером PostgreSQL
	 связаны с тем, что в переменных среды Windows не добавлен путь до
	 папки «Bin» драйвера PostgreSQL
	 в переменную «Path».


	Решение


	Необходимо подготовить сервер PostgreSQL строго в соответствии со
	 справочными материалами:


		- Процедура подготовки сервера PostgreSQL производится администратором
		 СУБД и состоит из шагов, описанных в разделе «[Подготовка
		 сервера PostgreSQL](Setup.chm::/03_DB_Server_Config/Postgres_server_preparation.htm)».


		- После успешного выполнения всех шагов из п.1 следует перейти
		 к [созданию
		 репозитория](Setup.chm::/05_RepoMngr/Setup_RepoMngr_CreateRepo.htm).


[![](../opened.gif)![](../closed.gif)Ошибка
 при конвертации справочника НСИ или составного справочника НСИ в табличный
 справочник НСИ ](javascript:TextPopup(this))


	Проблема


	Возникает ошибка
	 при конвертации справочника НСИ или составного справочника НСИ в табличный
	 справочник НСИ. Возможный текст ошибки:


	OLE\COM 0x80040E14.
	 Microsoft SQL Server Native Client 10.0 MSSQL-102: Incorrect syntax
	 near '@errno'.


	Причина


	Если ранее схема метаданных была перенесена с Microsoft SQL Server
	 версии 2008 на Microsoft SQL Server версии 2012, то справочники НСИ
	 не будут преобразованы. Перенос схем между различными версиями СУБД
	 не поддерживается из-за разницы в синтаксисе SQL.


	Решение


	Обновите репозиторий НСИ с помощью [менеджера
	 репозитория](Setup.chm::/05_RepoMngr/Setup_RepoMngr_UpdateRDSRepo.htm) (RepoMngr.exe). После успешного обновления
	 повторите конвертацию справочников.


[![](../opened.gif)![](../closed.gif)Возникают
 ошибки при работе в редакторе формул блока расчёта ](javascript:TextPopup(this))


	Проблема


	При работе в редакторе формул блока расчёта расширения «[Алгоритмы расчёта](CalculationAlgorithm.chm::/Purpose.htm)»
	 возникают ошибки вида: «Access violation…» и «Ошибка при загрузке
	 формы/компонента…».


	Причина


	Проблема не связана с «Форсайт. Аналитическая платформа»,
	 это системный дефект ОС Windows.


	Решение


	Для решения проблемы:


		- разрядность продукта «Форсайт. Аналитическая платформа»
		 должна совпадать с разрядностью ОС Windows;


		- установите последние обновления ОС Windows.


[![](../opened.gif)![](../closed.gif)Ошибка
 доступа к файлам при обновлении кеша куба ](javascript:TextPopup(this))


	Проблема


	При обновлении кеша куба в навигаторе репозитория или из прикладного
	 кода возникает ошибка доступа к файлам кеша. Также ошибка может возникнуть
	 при выполнении задачи обновления кеша в планировщике задач.


	Причина


	Файлы кеша заняты и используются каким-либо другим экземпляром «Форсайт. Аналитическая платформа».
	 Например, на одном компьютере запущен экземпляр BI-сервера и настольной
	 версии «Форсайт. Аналитическая платформа».


	Решение


	Обновление кеша куба должно производиться при условии, что запущен
	 только один экземпляр платформы. Планировщик задач рекомендуется запускать
	 на отдельном сервере где не будет использоваться настольная версия
	 или BI-сервер «Форсайт. Аналитическая платформа».
	 Также можно [настроить](Setup.chm::/UiWebSetup/03_Setup_Web/BI_Server_Registry_Key.htm#service)
	 выполнение задачи обновления кеша на отдельном BI-сервере.


[![](../opened.gif)![](../closed.gif)Ошибка
 открытия базы данных в веб-приложении](javascript:TextPopup(this))


	Проблема


	В веб-приложении при открытии объектов, связанных с базой данных,
	 возникает ошибка:


	Открытие базы данных
	 отменено.


	Причина


	При работе с объектами, связанными с базой данных, производится
	 открытие базы данных. Для открытия базы данных требуются учётные данные
	 пользователя.


	При создании базы данных не было настроено [автоматическое
	 подключение](uinavobj.chm::/database/UiDb_database_master_property.htm#log_in_automatically) и при открытии объектов должен открываться
	 диалог для ввода имени пользователя и пароля «[Авторизация
	 в базе данных](uinavobj.chm::/database/uidb_database_authorization.htm)», но он не поддерживается в веб-приложении.


	Решение


	Для решения проблемы в настольном приложении настройте [автоматическое
	 подключение](uinavobj.chm::/database/UiDb_database_master_property.htm#log_in_automatically) к базе данных:


		- Откройте используемую [базу данных](UiNavObj.chm::/database/UiDb_database.htm)
		 на редактирование.


		- Перейдите на страницу «[Свойства базы данных](UiNavObj.chm::/database/UiDb_database_master_property.htm)»
		 мастера редактирования базы данных.


		- Установите флажок «[Автоматическое
		 подключение](uinavobj.chm::/database/UiDb_database_master_property.htm#log_in_automatically)» и определите один из вариантов
		 подключения:


			- установите флажок «Использовать
			 учётные данные, указанные при входе в систему»;


			- укажите учётные данные пользователя, которые будут использоваться
			 для соединения с сервером.


		- Нажмите на кнопку «Далее».
		 Будет произведена проверка подключения к базе данных.


		- Нажмите кнопку «Готово»
		 на последней странице для завершения работы мастера.


[![](../opened.gif)![](../closed.gif)Ошибка
 при создании автоматического куба](javascript:TextPopup(this))


	Проблема


	В настольном приложении при создании [автоматического
	 куба](uinavobj.chm::/cube/createcube/master_auto/uimd_cube_createcube_master_auto.htm) возникает ошибка:


	В выбранной БД отсутствуют
	 необходимые для репозитория НСИ таблицы и процедуры.


	Причина


	Таблицы и процедуры, необходимые для репозитория метаданных НСИ,
	 отсутствуют или повреждены.


	Решение


	Для решения проблемы в настольном приложении:


		- [Создайте](Setup.chm::/05_repomngr/setup_repomngr_createrdsrepo.htm)
		 репозиторий метаданных НСИ.


		- [Обновите](Setup.chm::/05_repomngr/setup_repomngr_updaterdsrepo.htm)
		 репозиторий метаданных НСИ.


См. также:


[Решение
 возможных проблем с продуктом «Форсайт. Аналитическая платформа»](../FAQ_title.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
