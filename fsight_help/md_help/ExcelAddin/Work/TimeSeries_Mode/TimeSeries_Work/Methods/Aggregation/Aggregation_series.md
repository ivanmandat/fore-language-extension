# Агрегация (по рядам): Foresight Add-in for Excel

Агрегация (по рядам): Foresight Add-in for Excel
-


# Агрегация (по рядам)


Метод агрегирует данные по значениям атрибутов временных рядов. Входит
 в группу «[Агрегация](Aggregation.htm)».


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Для применения
 метода](javascript:TextPopup(this))


		- В таблице данных выделите один или несколько рядов.


		- Нажмите кнопку ![](../Aggregation_button.png) «Агрегация»,
		 расположенную на вкладке «Вычисления» ленты
		 инструментов.


		- В раскрывающемся списке кнопки выберите вариант «Агрегация».


После применения метода будет отображено окно «Агрегация»,
 предназначенное для настройки параметров расчёта:


![](Aggregation_series.png)


Задайте параметры агрегации:


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Период
 расчёта](javascript:TextPopup(this))


	Для задания периода расчета агрегации используйте группу параметров
	 «Период расчёта»:


		- Начало расчёта. Способ
		 вычисления начальной точки расчёта:


			- Определённая дата.
			 Дата указывается в редакторе дат, расположенном справа;


			- Сегодня +/-.
			 Дата равна текущему числу плюс число периодов, указанных в
			 редакторе чисел, расположенном справа;


			- От окончания расчёта.
			 Дата начала расчёта равна дате окончания расчёта минус число
			 периодов, указанных в редакторе чисел, расположенном справа.


	По умолчанию используется способ «Определенная дата» и начальная точка
	 расчёта совпадает с датой начала отображения данных;


		- Окончание расчёта.
		 Способ вычисления конечной точки расчёта:


			- Определённая дата.
			 Дата указывается в редакторе дат, расположенном справа;


			- Сегодня +/-.
			 Дата равна текущему числу плюс число периодов, указанных в
			 редакторе чисел, расположенном справа;


			- От начала расчёта.
			 Дата окончания расчёта равна дате начала расчёта минус число
			 периодов, указанных в редакторе чисел, расположенном справа.


	По умолчанию используется способ «Определенная дата» и конечная точка
	 расчёта совпадает с датой окончания отображения данных.


	Примечание.
	 При установленном окончании расчёта «От
	 начала расчёта» нет возможности установить начало расчёта в
	 значение «От окончания расчёта».


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Выражение
 агрегации](javascript:TextPopup(this))


	Для задания выражения агрегации используйте группу параметров «Выражение»:


		- Измерение. Измерение,
		 по которому необходимо выполнить агрегацию. Раскрывающийся список
		 содержит все измерения базы данных временных рядов, кроме календарного,
		 единиц измерения, ревизий и мнемоник;


		- Значение. Выражение
		 агрегации. Все допустимые выражения для агрегации отображаются
		 в списке, который можно вызвать, используя технологию IntelliSense:


			- Установите курсор в область «Значение».


			- Нажмите сочетание клавиш CTRL+ПРОБЕЛ.


	Будет отображен список доступных выражений
	 для агрегации.


	Все наименования атрибутов в выражении
	 агрегации указываются в фигурных скобках. Например: {BCI}+{BCA};


		- Фильтр. Ограничение
		 на временные ряды, по которым будет выполнена агрегация. Работа
		 с полем ведется аналогично работе с цепочкой навигации на панели
		 «Дерево
		 рядов»;


		- Динамика. Календарная
		 динамика для расчёта агрегации.


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Метод
 расчёта агрегации и его параметры](javascript:TextPopup(this))


	Для настройки метода расчета агрегации используйте параметры:


		- Метод. В раскрывающемся
		 списке укажите метод агрегации;


		- Веса. Укажите выражение
		 для расчёта весов агрегации. Раскрывающийся список доступен, если
		 используется метод взвешенной агрегации (например, взвешенная
		 сумма). В списке содержатся элементы измерения, выбранного в поле
		 «Измерение»;


		- Игнорировать ряды с пустыми
		 весами. Установка флажка определяет, игнорировать ли ряды,
		 для которых веса пустые. Если ряды игнорируются, то расчёт агрегации
		 занимает меньше времени. По умолчанию флажок снят и доступен,
		 если используется метод взвешенной агрегации (например, взвешенная
		 сумма);


		- Уровень. Установка
		 флажка определяет, будет ли после расчёта агрегации использоваться
		 функция «Level», сглаживающая
		 полученные данные.


	Флажок доступен, когда выбраны следующие
	 методы или их «взвешенные» аналоги:


			- веса;


			- взвешенное среднее геометрическое;


			- количество наблюдений;


			- количество пропусков;


			- сумма;


			- среднее;


			- медиана;


			- мода;


			- процентиль;


			- релевантность структуры.


	Флажок установлен автоматически и недоступен
	 для снятия, когда выбраны следующие методы или их «взвешенные» аналоги:


			- среднее, рассчитанное по темпам роста к соответствующему
			 периоду;


			- среднее, рассчитанное по процентному изменению;


			- среднее, рассчитанное по логарифмической разности;


			- среднее, рассчитанное по логарифмической разности к
			 соответствующему периоду;


			- среднее, рассчитанное по темпам роста к соответствующему
			 периоду;


			- среднее, рассчитанное по процентному изменению;


			- медиана, рассчитанная по процентному изменению.


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Параметры
 перемещения данных с одной календарной динамики на другую](javascript:TextPopup(this))


	Для применения функции «Rebase»,
	 позволяющей «перебазировать» данные с одной динамики на другую, установите
	 флажок «Перемещение».


	Примечание.
	 Флажок «Перемещение» доступен
	 в тех же случаях, что и флажок «[Уровень](#method)».


	Задайте дополнительные параметры перемещения:


		- Динамика. Календарная
		 динамика для расчёта функции «Rebase».
		 Доступна для изменения, если динамика агрегации отлична от годовой.
		 Функция «Rebase» может
		 быть применена для годовой динамики или динамик с более низкой
		 частотой, но не меньше динамики расчёта агрегации. Например, если
		 динамика расчёта агрегации - «Квартальная»,
		 то в раскрывающемся списке «Динамика»
		 будут доступны только варианты «Годовая»,
		 «Полугодовая» и «Квартальная»;


		- Базовый период.
		 Определяет период для расчёта функции «Rebase».
		 Формат задания периода зависит от указанной динамики. Например,
		 если выбрана годовая динамика, то задать можно будет только год,
		 в случае если выбрана полугодовая - необходимо задать полугодие
		 и год и т.д. Если поле «Динамика»
		 в группе «Перемещение»
		 недоступно, то формат периода зависит от поля «Динамика»
		 в группе «Выражение».


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Параметры
 релевантности структуры](javascript:TextPopup(this))


	Для задания релевантности агрегации с учетом пропусков в данных
	 используйте группу параметров «Релевантность
	 структуры»:


		- Порог. Определяет
		 значение порога для расчёта релевантности агрегации. Диапазон
		 допустимых значений: [0, 100]. Если порог равен «0», то агрегация
		 рассчитывается без учёта пропусков. Если порог равен «100», то
		 при расчёте агрегации учитываются все пропуски. Значение больше
		 «0», но меньше «100» означает, что пропуски учитываются согласно
		 установленному порогу;


		- Блок сравнения.
		 Блок сравнения для расчёта релевантности агрегации. Содержит список
		 элементов измерения, выбранного в поле «Измерение»
		 при настройке [выражения агрегации](#expression).


	Релевантность рассчитывается следующим образом: если сумма значений
	 элемента «Блок сравнения»,
	 разделенная на сумму всех значений, меньше значения «Порог»,
	 то агрегация не будет рассчитываться.


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Параметры
 использования общего периода данных](javascript:TextPopup(this))


	Общий период - период, на
	 котором у всех агрегируемых рядов есть данные.


	Для расчёта агрегации на общем периоде данных установите флажок
	 «Использование общего периода»
	 и задайте параметр:


		- Минимальное количество
		 наблюдений. Флажок определяет, накладывается ли ограничение
		 на минимальное количество наблюдений в общем периоде. По умолчанию
		 флажок снят и ограничение не накладывается. Если флажок установлен,
		 задайте минимальное число наблюдений в соответствующем редакторе
		 значений. По умолчанию общий период должен содержать минимум три
		 наблюдения.


	По умолчанию флажок «Использование
	 общего периода» снят и агрегация рассчитывается на периоде
	 модели.


[![](../../../../../Opened.gif)![](../../../../../Closed.gif)Параметры
 расчёта агрегации с учётом иерархии данных](javascript:TextPopup(this))


	Для расчёта агрегации с учётом иерархии данных установите флажок
	 «Учёт иерархии» и задайте
	 параметры:


		- Вся иерархия. Используется
		 по умолчанию. Агрегация рассчитывается по всем уровням иерархии;


		- Только первый уровень.
		 Агрегация рассчитывается только на один уровень вниз по иерархии;


		- Учитывать исходный элемент.
		 По умолчанию флажок снят и исходный элемент не учитывается в агрегации.
		 Если флажок установлен, то исходный элемент учитывается в агрегации.


	Примечание.
	 В расчёте агрегации с учётом иерархии принимают участие все иерархические
	 измерения.


	По умолчанию флажок «Учёт иерархии»
	 снят и расчёт ведется без учёта иерархии.


Если формула задана верно, то при нажатии кнопки «OK»
 диалог «Агрегация» будет закрыт,
 в таблицу данных будет добавлен вычисляемый ряд с наименованием «Aggregation», содержащий результаты
 расчёта.


## Настройка параметров расчёта


Для настройки специфических параметров агрегации используйте вкладки
 на панели свойств:


	- [Параметры](Parameters.htm).
	 Позволяет изменить базовые настройки агрегации: выражение агрегации,
	 метод расчёта и так далее;


	- [Параметры
	 сглаживания](Smoothing_Parameters.htm). Позволяет включить/отключить применение метода
	 «Уровень», функции «Rebase», изменить параметры релевантности
	 структуры;


	- [Периоды
	 расчёта](../Calculation_period.htm). Предназначена для настройки периода расчёта вычисляемого
	 ряда;


	- [Обработка
	 пропусков](../Missing_data_Methods.htm). Предназначена для настройки параметров метода
	 расчёта вычисляемого ряда и метода обработки пропусков.


См. также:


[Методы
 расчёта](../Calculation_Methods.htm) | [Агрегация](Aggregation.htm) | [Методы расчёта
 агрегации](lib.chm::/03_transformations/uimodelling_aggr.htm) | [Пример
 настройки расчета агрегации](Aggregation_Example.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
