# Кеширование объектов репозитория

Кеширование объектов репозитория
-


# Кеширование объектов репозитория


Для ускорения доступа к объектам и их работы используйте кеширование
 объектов репозитория.


При работе BI-сервера «Форсайт. Аналитическая платформа»
 извлечение и хранение данных, необходимых для работы веб-приложения, осуществляется
 в памяти самого BI-сервера.


Систему можно расширить путем введения дополнительных (более производительных)
 серверов, на которые будет возложена функция извлечения и кеширования
 данных из репозитория. BI-сервер будет обращаться к этим серверам и получать
 поток с необходимыми данными без дополнительного обращения к СУБД. Для
 введения дополнительных BI-серверов заполните раздел [Service](Setup.chm::/UiWebSetup/03_Setup_Web/BI_Server_Registry_Key.htm#service)
 в файле [settings.xml](Setup.chm::/UiWebSetup/03_Setup_Web/BI_Server_Settings_XML.htm#service)
 или в [настройках
 системного реестра](Setup.chm::/UiWebSetup/03_Setup_Web/BI_Server_Registry_Key.htm#service).


Кеширование доступно для некоторых типов объектов репозитория:


	- [справочники](UiNavObj.chm::/reference_book/Create.htm);


	- [базы
	 данных временных рядов](UiNavObj.chm::/TimeSeriesDatabase/CreateTimeSeriesDatabase.htm);


	- [регламентные
	 отчёты](UIReport.chm::/UiReport_purpose.htm);


	- [объекты
	 среды разработки](UiDevEnv.chm::/01_Development_Environment/01_Purpose_of_the_constructor/Purpose_of_the_constructor.htm).


Также кеширование доступно для [документов](UiNavObj.chm::/UiNavObj_document.htm)
 с некоторыми особенностями:


	- кеш документа формируется при его открытии. По умолчанию кеш
	 располагается в профиле пользователя, в подкаталоге %USERPROFILE%\AppData\Local\Foresight\Foresight Analytics Platform\AsmCache<порядковый номер>\Mod\<идентификатор репозитория>\<номер сборки>\CachedFiles\Documents;


	- кеш документа очищается при удалении самого документа.


[![](../Opened.gif)![](../Closed.gif)Кеширование
 справочников и измерений в базах данных временных рядов](javascript:TextPopup(this))


	Для использования кеширования справочника или базы данных временных
	 рядов:


		- Выберите объект репозитория в [навигаторе
		 объектов](GetStarted.chm::/Interface/Interface_Navigator.htm).


		- Включите кеширование, установив флажок «Кешируемый
		 объект» на вкладке «[Кеш](../03_Objects/UiNav_Obj_BasicPropCache.htm)»
		 в свойствах объекта.


	После выполнения действий будет использоваться кеширование выбранного
	 объекта репозитория.


	При кешировании справочников
	 и баз данных временных рядов
	 в оперативной памяти создаются временные копии объекта, содержащие
	 значения атрибутов элементов и ссылки на используемые объекты.


	Кеширование справочников и баз данных временных рядов работает интеллектуально
	 и доступно для разных пользователей, если они имеют одинаковые права
	 доступа и используют одинаковые значения параметров. Для разных значений
	 параметров справочников и баз
	 данных временных рядов одновременно может быть закешировано несколько
	 экземпляров одного и того же объекта.


[![](../Opened.gif)![](../Closed.gif)Кеширование
 регламентных отчётов](javascript:TextPopup(this))


	Для использования кеширования регламентного отчёта:


		- Выберите объект репозитория в [навигаторе
		 объектов](GetStarted.chm::/Interface/Interface_Navigator.htm).


		- Включите кеширование, выполнив команду «[Кеш
		 объекта](uireport.chm::/desktop/Report_in_cache.htm)» контекстного меню.


	После выполнения действий будет использоваться кеширование выбранного
	 объекта репозитория.


	При кешировании регламентных отчетов в базе репозитория создаются
	 экземпляры объекта, открытого с определенными значениями параметров.
	 При открытии объекта с параметрами осуществляется проверка наличия
	 в кеше записи, соответствующей данным параметрам. Если запись будет
	 найдена, то будет извлечена и открыта версия объекта из кеша. Если
	 запись для указанных параметров отсутствует, то будет открыта последняя
	 версия объекта из репозитория. При этом также будут открыты все объекты,
	 от которых он зависит.


[![](../Opened.gif)![](../Closed.gif)Кеширование
 объектов среды разработки](javascript:TextPopup(this))


	Для объектов репозитория осуществляется кеширование их скомпилированных
	 версий. Использование кеша позволяет ускорить запуск форм и выполнение
	 прикладного кода при работе прикладных проектов.


	Во время компиляции модулей/форм/сборок на локальном диске создаётся
	 файловый кеш, в котором хранится скомпилированная версия объекта.
	 При работе в ОС Linux кеш
	 располагается на BI-сервере в подкаталоге /opt/foresight/fp10.x-biserver/var/cache/AsmCache<порядковый номер>/Mod/<идентификатор репозитория>/<номер сборки>. При работе в
	 ОС Windows, по умолчанию,
	 кеш располагается в профиле пользователя, в подкаталоге %USERPROFILE%\AppData\Local\Foresight\Foresight Analytics Platform\AsmCache<порядковый номер>\Mod\<идентификатор репозитория>\<номер сборки>. При необходимости
	 путь хранения файлового кеша можно изменить. Для этого в ветке реестра
	 [HKEY_CURRENT_USER\Software\Foresight\Foresight Analytics Platform\10.0\10.9] создайте
	 строковый параметр CachefilePath и задайте в нём необходимый путь.


	Рекомендации:


		- следует помнить, что при компиляции изменённого модуля/формы/веб-формы
		 из среды разработки, произойдет его сохранение. После этого отсутствуют
		 гарантии открытия сохранённого объекта более ранней версией платформы;


		- разрабатываемые модули и формы необходимо компоновать и
		 хранить внутри сборок. Это уменьшает количество создаваемых файлов
		 в кеше, что приводит к уменьшению обращений к файловой системе
		 и ускоряет запуск кешированных объектов;


		- изменения в Fore-коде, сделанные в момент работы пользователей,
		 будут применены только после выгрузки и новой загрузки скомпилированных
		 сборок. В случае с обработчиком событий, например, для применения
		 нового кода потребуется закрыть все объекты, которые используют
		 этот обработчик;


		- сборки/модули, в коде которых используются [статические
		 поля классов](Fore.chm::/02_GeneralInfo/Fore_ClassesAndObjects.htm#shared), выгружаются только при выходе
		 из репозитория, поэтому необходимо перезайти в репозиторий, чтобы
		 применились изменения в таком коде;


		- проводите очистку кэша сборок в репозитории при отсутствии
		 активных пользователей. Это позволит избежать непредвиденных последствий;


		- при установке обновлений с включенной настройкой «[Устанавливать
		 дату изменения объектов из обновления](UpdManager.chm::/UpdateProcess_Parameters.htm)» необходимо
		 принудительно очистить кеш сборок на всех BI-серверах. Не рекомендуется
		 использовать данную настройку при обновлении объектов среды разработки.
		 Это связано с тем, что в кеше сборок хранится дата и время компиляции.
		 Для перекомпиляции дата и время в кеше должно быть более ранним,
		 чем дата и время изменения объекта в базе данных. А так как в
		 базе данных сохранится время из обновления, то это условие может
		 быть невыполнимо.


Для использования актуальных данных очистите кеш при необходимости.


## Очистка кеша


Очистка кеша позволяет избежать использования потенциально устаревших
 данных. В зависимости от используемой ОС доступны различные возможности
 по очистке кеша.


	 Linux

	 Windows


		Для удаления кеша объектов среды разработки удалите файлы в
		 подкаталоге /opt/foresight/fp10.x-biserver/var/cache/AsmCache<порядковый номер>/Mod/<идентификатор репозитория>
		 для требуемого репозитория. Очистка осуществляется администратором
		 BI-сервера в моменты простоя системы и при отсутствии подключенных
		 пользователей.


		Для очистки кеша репозитория выполните команду «Сервис >
		 Очистить кеш» в главном меню навигатора объектов.


		Для очистки кеша справочников и баз данных временных рядов нажмите
		 кнопку «Очистить кеш»
		 на вкладке «[Кеш](../03_Objects/UiNav_Obj_BasicPropCache.htm)»
		 в свойствах объекта.


		Для очистки кеша регламентного отчета нажмите кнопку «Очистить» в окне «[Кеш
		 объекта](uireport.chm::/desktop/Report_in_cache.htm)».


		Для очистки кеша объектов среды разработки выполните команду
		 «Репозиторий > Очистить
		 кеш сборок» в главном меню менеджера безопасности.


Для работы с кешем различных объектов из языка Fore используйте свойства
 и методы интерфейсов [IMetabase](KeSom.chm::/Interface/IMetabase/IMetabase.htm),
 [IMetabaseObject](KeSom.chm::/Interface/IMetabaseObject/IMetabaseObject.htm).
 Для очистки кеша объектов используйте метод [IMetabaseCache.FlushAll](KeSom.chm::/Interface/IMetabaseCache/IMetabaseCache.FlushAll.htm).


См. также:


[Кеширование](UiNav_Cache.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
