# Total

Total
-


# Total


## Синтаксис


SubTotal(Type: [PivotEvaluatorElementType](kepivot.chm::/enums/pivotevaluatorelementtype.htm),


Relation: Variant,


Position: [PivotTotalPosition](kepivot.chm::/enums/pivottotalposition.htm))


## Параметры


Type. Метод вычисления итогов;


Relation. Элемент измерения,
 по которому необходимо получить рассчитанный итог. Необязательный параметр.
 По умолчанию параметр имеет значение Null;


Position. Расположение итога
 (по строкам/по столбцам). Необязательный параметр. Значение по умолчанию
 PivotTotalPosition.Default_ -
 расположение не определено.


## Описание


Возвращает значение итога.


## Комментарии


Обязательным требованием для работы метода является включение расчета
 необходимых итогов для [строк](kepivot.chm::/Interface/IPivotEvaluatorTotals/IPivotEvaluatorTotals.RowTypes.htm)/[столбцов](kepivot.chm::/Interface/IPivotEvaluatorTotals/IPivotEvaluatorTotals.ColumnTypes.htm)
 таблицы. Если итоги не рассчитываются, то метод вернет пустые значения.


Если параметр Relation не указан,
 то функция вернет итог того элемента, после которого создается вычисляемый
 элемент. В качестве значения параметра Relation
 необходимо указывать элемент того измерения, для которого создается вычисляемый
 элемент. При указании параметра Relation
 функция вернет общий итог, рассчитанный по указываемому элементу.


Если параметр Position не указан
 или значение совпадает с расположением создаваемого вычисляемого элемента,
 то функция вернёт итог элемента, для которого задается формула преобразования.
 Если указывается значение, являющееся противоположным относительно расположения
 вычисляемого элемента (вычисляемый элемент расположен в столбцах и указывается
 значение [PivotTotalPosition.Rows](kepivot.chm::/enums/pivottotalposition.htm),
 и наоборот), то функция вернёт значение промежуточного итога по строкам/столбцам
 соответственно.


При использовании метода Total
 в качестве функции в выражениях формул учитывайте следующие особенности:


	- если вычисляемый элемент расположен
	 в столбцах и функция задана с параметром «Итоги по столбцам» или если
	 вычисляемый элемент расположен в строках и функция задана с параметром
	 «Итоги по строкам»:


		- если функция Total
		 задается для существующего элемента измерения без указания конкретного
		 элемента в формуле и для таблицы рассчитан соответствующий метод
		 итога, то общий итог будет вычислен по данному элементу;


		- если был добавлен новый вычисляемый элемент и для него не
		 была рассчитана формула, откуда можно взять итог, то значение
		 функции Total по данному
		 вычисляемому элементу будет пустым;


		- если для вычисляемого элемента в формуле указать другой
		 элемент, то общий итог будет рассчитан по указанному элементу;


	- если вычисляемый элемент расположен
	 в столбцах и функция задана с параметром «Итоги по строкам» или если
	 вычисляемый элемент расположен в строках и функция задана с параметром
	 «Итоги по столбцам», то значение вычисляемого элемента будет соответствовать
	 значению общего итога по строкам/столбцам соответственно.


Если итог по строкам/столбцам не рассчитан, то соответствующая функция,
 заданная в формулах, вернёт пустое значение.


## Пример


		 Формула
		 Результат
		 Применение


		 = Total(PivotEvaluatorElementType.Sum, Null, PivotTotalPosition.Rows)
		 Рассчитан расположенный по строкам общий итог в виде суммы
		 соответствующих измерений, находящихся выше вычисляемого элемента.
		 Можно использовать в формулах вычисляемых элементов.


См. также:


[Функции, доступные в редакторе
 выражения](../../Expression_editor_func.htm) │ [Итоги](Func_Totals.htm) │ [IPivotClass.Total](kepivot.chm::/interface/ipivotclass/ipivotclass.total.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
