# Отладка расчёта алгоритма: Настольное приложение

Отладка расчёта алгоритма: Настольное приложение
-


# Отладка расчёта алгоритма


Отладка расчёта алгоритма предназначена для выявления и исправления
 ошибок, а также позволяет посмотреть промежуточные значения, полученные
 в ходе расчёта. Просмотр промежуточных значений особенно актуален, если
 внутри расчёта используются промежуточные кубы без таблиц с данными, то
 есть по таким кубам нельзя просмотреть полученные значения после окончания
 расчёта алгоритма.


Для отладки алгоритма:


	- Настройте выполнение расчёта с помощью окна «Настройка
	 выполнения расчёта».


[![](../../Opened.gif)![](../../Closed.gif)Для
 открытия окна](javascript:TextPopup(this))


	Для открытия окна «Настройка
	 выполнения расчёта» нажмите кнопку ![](b_calculation_settings.png) «Настройка выполнения расчёта» на
	 вкладке «Расчёт» ленты инструментов.


![](calculation_setup.png)


Задайте параметры:


		- Проверять арифметические операции. Установите флажок для проверки
		 арифметических операций, используемых в [формулах
		 расчёта](../Calculation_block/Formula.htm). Если при
		 расчёте алгоритма в формуле производится деление на ноль, то будет
		 выдано соответствующее сообщение с указанием формулы расчёта и
		 блока:


![](error.png)


Для коррекции указанной формулы нажмите кнопку
 «Остановить», после чего будет
 остановлен расчёт алгоритма. Отредактируйте формулу вручную и выполните
 повторный расчёт алгоритма.


Для пропуска ошибки нажмите кнопку «Пропустить». После чего рассчитываемые
 элементы пропускаются и результатом такого расчёта является пустое значение.


При снятом флажке проверка арифметических
 операций в формулах не выполняется. Если производится деление на ноль,
 то рассчитываемые элементы пропускаются и результатом такого расчёта является
 пустое значение;


Примечание.
 Проверку арифметических операций можно не выполнять, если формула расчёта
 задана верно и в результате расчёта допустимо содержание пустых значений.


		- Не сохранять результат
		 в БД. Установите флажок для [расчёта
		 алгоритма целиком](Perform_calculations.htm#full) или [расчёта
		 отдельных блоков](Perform_calculations.htm#part) без сохранения данных. При снятом флажке
		 результаты расчёта алгоритма сохраняются;


		- Многопоточный расчет.
		 Установите флажок для ускорения расчёта [блоков
		 расчёта](../Calculation_block/Calculation_unit.htm) и [блоков
		 контроля](../Control_Block/Control_Block.htm), если установлен флажок «[Многопоточный
		 расчет](../Calculation_block/Master_calculation_block_page_consumer.htm)» в мастере редактирования блока расчёта или
		 блока контроля. Для блоков агрегации выполняется только однопоточный
		 расчёт. Для получения подробной информации о многопоточном расчёте
		 обратитесь к разделу «[Как
		 выполнять многопоточный расчёт?](../../FAQ/MultiThreadedCalculation.htm)». По умолчанию флажок снят и
		 выполняется однопоточный расчёт алгоритма;


		- Поточечный расчет.
		 Установите флажок для изменения способа расчёта [формул](../Calculation_block/Formula.htm)
		 во всех [блоках
		 расчёта](../Calculation_block/Calculation_unit.htm) и [блоках
		 контроля](../Control_Block/Control_Block.htm), которые содержатся в алгоритме. При поточечном расчёте
		 алгоритма выполняется последовательный расчёт формул в каждой
		 точке данных: сначала формулы рассчитываются по первой точке данных,
		 затем по второй точке и так далее. Такой расчёт можно использовать,
		 если данные по текущей календарной точке зависят от данных, рассчитанных
		 по предыдущей календарной точке. При снятом флажке используется
		 векторный расчёт, то есть формулы рассчитываются по всем точкам
		 данных.


[![](../../Opened.gif)![](../../Closed.gif)Схемы
 расчёта формул](javascript:TextPopup(this))


	Расчёт элементов измерения, значения
	 которых рассчитывают формулы, при использовании поточечного расчёта
	 алгоритма:


	![](scheme_1.png)


	Расчёт элементов измерения, значения
	 которых рассчитывают формулы, без использования поточечного расчёта
	 алгоритма:


	![](scheme_2.png)


Примечание.
 Флажок доступен, если в алгоритме расчёта содержатся [блоки
 расчёта](../Calculation_block/Calculation_unit.htm) и [блоки
 контроля](../Control_Block/Control_Block.htm), для которых заданы [формулы
 расчёта](../Calculation_block/Formula.htm).


Если установлен флажок «[Поточечный
 расчет](../Calculation_block/Additional_Calculation_and_Data_Saving_Parameters.htm)» для конкретных формул расчёта, то расчёт может выполняться
 несколькими способами. Способы расчёта формул приведены на схемах ниже.


[![](../../Opened.gif)![](../../Closed.gif)Схемы
 расчёта формул](javascript:TextPopup(this))


	Расчёт элементов измерения, значения
	 которых рассчитывают формулы, при использовании поточечного расчёта
	 алгоритма и поточечного расчёта каждой формулы в блоке:


	![](scheme_1.png)


	Расчёт элементов измерения, значения
	 которых рассчитывают формулы, без использования поточечного расчёта
	 алгоритма, но с использованием поточечного расчёта каждой формулы
	 в блоке:


	![](scheme_3.png)


	Расчёт элементов измерения, значения
	 которых рассчитывают формулы, без использования поточечного расчёта
	 алгоритма, но с использованием поточечного расчёта формул, например,
	 только в блоке 1:


	![](scheme_4.png)


Если в формуле расчёта используются элементы
 атрибута [версионного
 справочника](UiNavObj.chm::/reference_book/FAQ/UiRds_Work_RDS_Elements_work_2.htm), то при расчёте алгоритма значения элементов
 будут одинаковыми для каждой календарной точки.


Важно.
 Использование параметра приводит к снижению производительности и продолжительному
 расчёту алгоритма.


Если в алгоритме расчёта содержатся [блоки
 агрегации](../Aggregation_block/Aggregation_block.htm), то при использовании поточечного расчёта алгоритма невозможен
 расчёт агрегации для одной календарной точки. Выберите способ расчёта
 блоков агрегации с помощью переключателей:


			- Не рассчитывать агрегацию.
			 Блоки агрегации не будут рассчитаны;


			- Рассчитать до поточечного
			 расчёта. Блоки агрегации будут рассчитаны до поточечного
			 расчёта блоков расчёта и блоков контроля;


			- Рассчитать после поточечного
			 расчёта. По умолчанию. Блоки агрегации будут рассчитаны
			 после поточечного расчёта блоков расчёта и блоков контроля.


Примечание.
 Порядок расчёта блоков агрегации в [дереве
 расчёта](Beginning_of_work.htm) учитывается только при использовании поточечного расчёта конкретных
 формул расчёта. При использовании поточечного расчёта алгоритма порядок
 расчёта блоков агрегации зависит от выбранного способа расчёта.


Для применения заданных параметров нажмите
 кнопку «Применить».


	- Если в нескольких блоках используется разная отметка одного
	 и того же источника, установите флажок «Загружать
	 данные отдельно от остальных» в контекстном меню этих блоков
	 в дереве расчёта. Раздельная загрузка данных в таком случае выполняется
	 быстрее и сокращает общее время расчёта алгоритма. Флажок доступен
	 для всех видов блоков.


	- Для отладки всего алгоритма нажмите кнопку ![](b_debug_calculate.png) «Рассчитать алгоритм» в группе «Отладка».

	Для отладки отдельных блоков выделите их в рабочей области или дереве
	 расчёта. Для этого в рабочей области используйте клавишу SHIFT, в
	 дереве расчёта - клавишу CTRL или SHIFT. После выбора блоков нажмите
	 кнопку ![](b_debug_calculateSelected.png) «Рассчитать
	 выделенные» в группе «Отладка».


	- После запуска расчёта начнётся загрузка данных в алгоритм. После
	 окончания загрузки станет доступна кнопка ![](b_continue.png) «Продолжить». Нажмите её для перехода
	 к следующему шагу в расчёте.


Рассчитанный блок меняет свой вид в рабочей
 области: он становится зелёным. Например, слева блок до расчёта, справа
 - после расчёта:


![](debugObj.png)


	- Для перехода к определённому шагу расчёта выберите его в раскрывающемся
	 меню кнопки ![](b_continue.png) «Продолжить».
	 В меню содержатся все шаги, которые ещё не были выполнены.


	- Для остановки расчёта нажмите кнопку ![](b_stop.png) «Остановить» в группе «Отладка».


Во время отладки расчёта все объекты алгоритма доступны для чтения.
 Например, можно посмотреть настройки блока расчёта или [открыть
 результаты расчёта](DataView.htm) блока в инструменте «Аналитические
 запросы (OALP)».


Примечание.
 Если при настройке выполнения расчёта был установлен флажок «Не
 сохранять результаты в БД», но после окончания расчёта необходимо
 сохранить данные, то нажмите кнопку ![](b_saveData.png) «Сохранить значения» в группе
 «Параметры расчёта».


После завершения отладки расчёта будет отображен диалог с результатами.
 Например:


![](CulculationResult.png)


Если при расчёте возникла ошибка, то будет отображено соответствующее
 сообщение.


Примечание.
 Если в структуре алгоритма расчёта содержатся [ветвления](CalculationConditions.htm),
 то при расчёте алгоритма проверяются условия выполнения веток. В результате
 проверки загружаются только те источники данных, которые заданы для объектов,
 содержащихся в удовлетворяющих условиям ветках. Данная оптимизация позволяет
 сократить время загрузки данных.


Для ускорения расчёта алгоритма обратитесь к разделу «[Как
 ускорить расчёт алгоритма?](../../FAQ/Acceleration_of_Algorithm_Calculation.htm)».


См. также:


[Начало
 работы с расширением «Алгоритмы расчёта» в веб-приложении](../../Web/Work/Beginning_of_work.htm) | [Построение алгоритма
 расчёта](Construction_of_the_calculation_algorithm.htm) | [Как
 выполнять многопоточный расчёт?](../../FAQ/MultiThreadedCalculation.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
