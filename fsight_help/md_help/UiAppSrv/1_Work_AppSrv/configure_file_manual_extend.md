# Расширение конфигурационного файла вручную: Планировщик задач

Расширение конфигурационного файла вручную: Планировщик задач
-


# Расширение конфигурационного файла вручную


	Расширение конфигурационного файла Scheduler.xml требуется в случае,
	 если при [автоматическом
	 создании](UiAppSrv_Work_AppSrv_createXML.htm) конфигурационного файла не были созданы необходимые разделы
	 в структуре.


	Для расширения конфигурационного файла вручную:


		- Откройте на редактирование файл Scheduler.xml, расположенный:


			- в папке /opt/foresight/fp10.x-biserver/etc
			 в ОС Linux;


			- рядом с исполняемым файлом планировщика Scheduler.exe
			 в папке C:\Program Files\Foresight\Analytics Platform
			 10.x
			 в ОС Windows.


		- Внесите необходимые изменения согласно [структуре
		 конфигурационного файла](#config_structure) и описанию разделов.


		- Убедитесь, что в [реестре](Setup.chm::/06_AK_Client_Config/Configuring_repository_list_in_the_system_registry.htm#repository_list)
		 или файле [Metabases.xml](Setup.chm::/06_AK_Client_Config/Configuring_repository_list_in_the_system_registry.htm#metabase_xml_list)
		 заданы параметры подключения к репозиториям, в которых содержатся
		 контейнеры запланированных задач, указанные в файле Scheduler.xml.


		- Сохраните файл и [обновите
		 настройки](../3_Work_Tasks/Update_config_AppSrv.htm) планировщика задач.


## Структура файла Scheduler.xml


	Файл Scheduler.xml должен состоять из раздела <Metabases>,
	 содержащего список репозиториев. Настройки каждого репозитория задаются
	 в разделе, название которого соответствует идентификатору репозитория.
	 Для каждого репозитория создаются разделы [<LogonData>](#logondata),
	 [<Credentials>](#credentials), [<TaskContainer>](#taskcontainer),
	 [<LOG>](#log), [<Host>](#host).


	Примечание.
	 Раздел Host необходим, если в параметрах задач контейнера настроена
	 [отправка
	 сообщений по электронной почте](../3_Work_Tasks/UiAppSrv_Work_Tasks_CreateTask_Rezult.htm#email) или [сохранение
	 файла на FTP-сервер](../3_Work_Tasks/UiAppSrv_Work_Tasks_CreateTask_Rezult.htm#ftp). Данный раздел и раздел LOG не создаются автоматически.
	 Если в настройках конфигурационного файла планируется более одного
	 подключения к репозиторию, то настройки в разделах Host и LOG считаются
	 с первого подключения и используются для всех последующих.


	В файле Scheduler.xml могут содержаться настройки для запуска одного
	 или нескольких контейнеров запланированных задач. Убедитесь, что выполняются
	 следующие условия:


		- контейнер настроен на запуск только в одном планировщике
		 задач. Использование нескольких планировщиков задач для запуска
		 одного контейнера недопустимо;


		- запуск нескольких контейнеров в одном планировщике задач
		 должен выполняться в рамках одной базы данных.


	Пример файла Scheduler.xml с настройками запуска двух контейнеров
	 задач, содержащихся в разных репозиториях, которые расположены в одной
	 базе данных:


		- контейнер задач с идентификатором TASK_CONTEINER_1 в репозитории
		 REPOSITORY_ID;


		- контейнер задач с идентификатором TASK_CONTEINER_2 в репозитории
		 WAREHOUSE.


	<Metabases ThreadsCount="10" ProcessLocale="1033"
	 UILocale="1033">

	  <REPOSITORY_ID Name="REPOSITORY_ID" Authentication="1"
	 Driver="POSTGRES" Package="STANDARDSECURITYPACKAGE">

	    <LogonData DATABASE="DATABASE_NAME"
	 SERVER="SERVER_NAME" />

	    <Credentials Authentication="1"
	 USER="User1" PASSWORD="Password1" />

	    <TaskContainer KEY="430979" ID="TASK_CONTEINER_1"
	 RestartSecs="300" />

	    <LOG Logging="1" File = "File.log"
	 MaxRecordCount = "1000" />

	    <Host>

	      <Mail Host="mail.example.com"
	 Port="0" From="user1@example.com" EnableSsl="1"
	 />

	      <Ftp Agent="Foresight application
	 server" AccessType="0" ProxyName="" />

	      <Credentials USER="domain\user"
	 PASSWORD="password" Ask="0" AuthProtocol="LOGIN"
	 />

	      <MailTo Mail="admin@example.com"
	 />

	    </Host>

	  </REPOSITORY_ID>

	  <WAREHOUSE Name="WAREHOUSE" Authentication="1"
	 Driver="POSTGRES" Package="STANDARDSECURITYPACKAGE">

	    <LogonData DATABASE="DATABASE_NAME"
	 SERVER="SERVER_NAME" />

	    <Credentials Authentication="1"
	 USER="User2" PASSWORD="Password2" />

	    <TaskContainer KEY="637482" ID="TASK_CONTEINER_1"
	 RestartSecs="300" />

	  </WAREHOUSE>

	</Metabases>


### Раздел Metabases


	Раздел представляет собой список репозиториев, а также может содержать
	 собственный набор атрибутов:


			 Атрибуты
			 Описание


			 ProcessLocale
			 Значение региональных настроек для планировщика задач.


Если данный атрибут не задан, то значение
			 региональных настроек будет взято из настроек операционной
			 системы.


			 UILocale
			 Значение языка интерфейса планировщика задач.

Если данный атрибут не задан, то значение
			 берётся из языковых настроек «Форсайт. Аналитическая платформа»
			 для текущего пользователя. Если языковые настройки не заданы,
			 то они будут соответствовать значению атрибута ProcessLocale.


			 ThreadsCount
			 Максимальное количество [одновременно
			 выполняемых задач](UiAppSrv_Work_AppSrvXml_Flow.htm) в планировщике задач.

Необходимость ограничения количества выполняемых
			 потоков обусловлена определёнными проблемами на сервере, например,
			 нехваткой памяти, возникающими при одновременном выполнении
			 большого количества задач.

Если атрибут не задан, то работа осуществляется
			 без ограничений.


### Раздел настроек репозитория


	Настройки каждого репозитория задаются в разделе, название которого
	 соответствует идентификатору репозитория. Данный раздел содержит собственный
	 набор атрибутов и подразделы.


			 Атрибуты
			 Описание


			 Name
			 Наименование репозитория.


			 Authentication
			 Тип аутентификации:


				- 1. Парольная;


				- 2. Интегрированная
				 доменная;


				- 3. Ролевая.


			Примечание.
			 Ролевой тип аутентификации является устаревшим и используется
			 для совместимости с прошлыми версиями.


			 Driver
			 Идентификатор СУБД:


				- ORCL8 - Oracle;


				- MSSQL2012 - Microsoft SQL Server;


				- MSSQL2012ODBC - Microsoft SQL Server (ODBC);


				- POSTGRES - PostgreSQL;


				- SQLITE - SQLite.


			 Package
			 Тип пакета безопасности:


				- STANDARDSECURITYPACKAGE.
				 Стандартный пакет безопасности.


			 DL
			 Признак отложенной загрузки дескрипторов:


				- true. При
				 подключении к репозиторию выполняется отложенная загрузка
				 дескрипторов объектов репозитория;


				- false. По
				 умолчанию. При подключении к репозиторию не выполняется
				 отложенная загрузка дескрипторов объектов репозитория.


			Для получения подробной информации об особенностях использования
			 отложенной загрузки дескрипторов обратитесь к разделу «[Настройка
			 подключения к репозиторию](setup.chm::/06_AK_Client_Config/UiNav_RepoConfig_repo1.htm#delayed_loading)».


#### Раздел LogonData


	Раздел содержит параметры подключения к репозиторию:


			 Атрибуты
			 Описание


			 DATABASE
			 Идентификатор базы данных, к которой будет осуществляться
			 подключение по умолчанию. Указывается при работе с одной из
			 СУБД: PostgreSQL, Microsoft SQL Server.


			 FILENAME
			 Имя файла с настройками подключения к базе данных. Указывается
			 при работе с СУБД SQLite.


			 ODBCPARAMS
			 [Дополнительные
			 параметры](Setup.chm::/06_AK_Client_Config/UiNav_RepoConfig_repo1.htm#more) подключения к репозиторию с помощью
			 параметра «Строка подключения».
			 Указывается при работе с СУБД Microsoft SQL Server.


			 SERVER
			 IP-адрес или DNS-имя, под которым зарегистрирован сервер
			 СУБД с подключаемой базой данных. Указывается при работе с
			 одной из СУБД: Oracle, PostgreSQL, Microsoft SQL Server.


			 SCHEME
			 Наименование схемы, в которой создан репозиторий. Указывается
			 при работе с СУБД Oracle.


	Для получения подробной информации
	 об актуальных версиях СУБД обратитесь к разделу «[Поддерживаемые СУБД](Setup.chm::/01_SysReq/database_Support.htm)».


#### Раздел Credentials


	Раздел содержит параметры сохранения учётных данных пользователя,
	 используемых при подключении к базе данных:


			 Атрибуты
			 Описание


			 Authentication
			 Тип авторизации в репозитории при запуске планировщика
			 задач:


				- 0. Тип авторизации
				 выбирается в момент запуска;


				- 1. Парольная
				 авторизация;


				- 2. Доменная
				 авторизация;


				- 6. Парольная
				 с шифрованием регистрационных данных.


			 USER
			 Имя пользователя для парольной авторизации.


			 PASSWORD
			 Пароль пользователя для парольной авторизации.


			 Ask
			 Признак запроса имени пользователя и пароля при авторизации
			 в репозитории:


				- 1. Запрашивать
				 имя пользователя и пароль. Будет открыт [диалог
				 авторизации](UiAppSrv_Work_AppSrv.htm). Если тип авторизации выбирается в момент
				 запуска планировщика задач, то при запросе имени пользователя
				 и пароля будет возможно использовать доменную авторизацию.


			Если данный атрибут отсутствует, то имя пользователя и пароль
			 при авторизации не запрашиваются.


#### Раздел TaskContainer


	Раздел содержит параметры контейнера задач:


			 Атрибуты
			 Описание


			 KEY
			 [Ключ](uinav.chm::/03_Objects/UiNav_Obj_BasicPropGeneral.htm)
			 контейнера задач в указанном репозитории.


			 ID
			 Идентификатор контейнера задач в указанном репозитории.


			 RestartSecs
			 Интервал проверки контейнера задач в секундах.


#### Раздел LOG


	Раздел содержит параметры ведения журнала операций:


			 Атрибуты
			 Описание


			 Logging
			 Признак ведения журнала операций:


				- 1. Журнал
				 операций ведётся;


				- 0. Журнал
				 операций не ведётся.


			 File
			 Имя файла, в котором будет вестись журнал операций.

Если атрибут отсутствует, то по умолчанию
			 будет использоваться файл Scheduler.log. Файл журнала операций
			 располагается в папке с установленным продуктом «Форсайт. Аналитическая платформа».


			 MaxRecordCount
			 Максимальное количество записей в журнале операций.

Если атрибут отсутствует, то по умолчанию
			 устанавливается максимальное количество записей в журнале
			 операций равное 10 000 000.


	Если раздел не задан, то логирование не выполняется.


#### Раздел Host


	Раздел необходим, если в параметрах задач контейнера настроена [отправка
	 сообщений по электронной почте](../3_Work_Tasks/UiAppSrv_Work_Tasks_CreateTask_Rezult.htm) или [сохранение
	 файла на FTP-сервер](../3_Work_Tasks/UiAppSrv_Work_Tasks_CreateTask_Rezult.htm#ftp).


	Примечание.
	 Отправка уведомлений по электронной почте доступна только для задач,
	 выполняемых по [расписанию](../3_Work_Tasks/UiAppSrv_Work_Tasks_CreateTask_TimeTable.htm).
	 При запуске задач [вручную](../3_Work_Tasks/view_task_state.htm#manual_task)
	 сообщения не отправляются.


##### Раздел Mail


	Раздел содержит параметры подключения к электронной почте:


			 Атрибуты
			 Описание


			 Host
			 Сервер для отправки сообщений по электронной почте.


			 Port
			 Номер порта для электронной почты.


			 From
			 Электронный почтовый ящик, который будет указан как отправитель.


			 EnableSsl
			 Признак использования SSL-шифрования для отправки сообщений
			 через внешние почтовые серверы:


				- 1. Используется;


				- 0. Не используется.


##### Раздел Ftp


	Раздел содержит параметры подключения к FTP-серверу:


			 Атрибуты
			 Описание


			 Agent
			 Имя приложения, которое используется для подключения к
			 FTP-серверу.


			 AccessType
			 Тип требуемого доступа:


				- 0. Используются
				 настройки реестра;


				- 1. Используется
				 интернет;


				- 2. Используется
				 прокси.


			 ProxyName
			 Имя прокси-сервера. Указывается, если для атрибута AccessType задано значение
			 «2».


##### Раздел Credentials


	Данный раздел необходим, если сервер исходящей почты запрашивает
	 авторизацию.


			 Атрибуты
			 Описание


			 USER
			 Имя пользователя для авторизации на сервере исходящей почты.


Если в атрибуте USER встречается знак «\»,
			 то до знака указывается домен, после – имя пользователя.


			 PASSWORD
			 Пароль пользователя для авторизации на сервере.


			 Ask
			 Признак запроса имени пользователя и пароля при авторизации:


				- 1. Выводить
				 [диалог авторизации](UiAppSrv_Work_AppSrv.htm)
				 на сервере исходящей почты.


			Если данный атрибут отсутствует, то имя пользователя и пароль
			 при авторизации не запрашиваются, а используются указанные
			 данные в атрибутах USER
			 и PASSWORD.


			 AuthProtocol
			 Протокол аутентификации на SMTP-сервере. В качестве значения
			 параметра указывается один из протоколов, которые поддерживает
			 SMTP-сервер, с которым осуществляется работа. Например, PLAIN, LOGIN
			 и другие. Список поддерживаемых протоколов можно получить
			 изучив параметры конкретного SMTP-сервера. Если протокол не
			 известен, укажите пустую строку. В этом случае SMTP-сервер
			 сам выберет, каким образом будет осуществляться аутентификация
			 пользователя.

Если данный атрибут отсутствует, то аутентификация
			 на SMTP-сервере будет осуществляться по протоколу LOGIN.


##### Раздел MailTo


			 Атрибут
			 Описание


			 Mail
			 Электронный почтовый ящик, на который будет отправлено
			 письмо при подключении к репозиторию. Письмо будет содержать
			 информацию об удачном/неудачном подключении. Также на данный
			 адрес будут отправляться сообщения об ошибках, не связанных
			 с выполнением задач.


См. также:


[Создание
 конфигурационного файла](UiAppSrv_Work_AppSrvXml.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
