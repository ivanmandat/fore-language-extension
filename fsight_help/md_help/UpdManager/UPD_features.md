# Особенности установки обновления

Особенности установки обновления
-


# Особенности установки обновления


Для некоторых объектов репозитория существует ряд особенностей при установке
 обновления.


## Обновление контейнера моделирования, содержащего переменные, созданные
 в веб-приложении


Если в контейнере моделирования содержатся переменные, не использующие
 внешние источники данных и созданные в веб-приложении, то контейнер моделирования
 будет содержать внутреннюю базу данных временных рядов.


[![](Opened.gif)![](Closed.gif)Порядок шагов
 для корректного обновления](javascript:TextPopup(this))


		- Если в обновляемом репозитории никогда не создавали репозиторий
		 НСИ, то [создайте
		 репозиторий НСИ](Setup.chm::/05_RepoMngr/Setup_repoMngr_CreateRDSRepo.htm) с помощью менеджера репозитория.


		- С помощью [навигатора
		 объектов](GetStarted.chm::/Interface/Interface_Navigator.htm) в обновляемом репозитории создайте:


		-


			- [базу
			 данных](UiNavObj.chm::/database/UiDb_database.htm);


			- [репозиторий
			 НСИ](UiNavObj.chm::/repository_RDS/RepositoryRDS.htm), использующий созданную БД;


			- [базу
			 данных временных рядов](UiNavObj.chm::/TimeSeriesDatabase/CreateTimeSeriesDatabase.htm), использующую созданный
			 репозиторий НСИ.


		- Откройте репозиторий, содержащий требуемый контейнер моделирования.


		- [Создайте обновление](CreateUpdate/Admin_CreateUpdate.htm)
		 и [добавьте](CreateUpdate/Admin_CreateUpdate_AddObjects.htm)
		 в него контейнер моделирования со всеми вложенными объектами.


		- С помощью менеджера обновлений выстроите объекты созданного
		 обновления в порядке зависимости.


		- Установите необходимые параметры обновления: тип, способ,
		 условие обновления и другие параметры.


		- [Сохраните
		 обновление в файл](SaveUpdate/Admin_SaveUpdate.htm#in_file).


		- Откройте обновляемый репозиторий и запустите [установку
		 обновления](Admin_UpMBObj_DoUpdate.htm) из созданного файла.


		- В процессе обновления будут отображены [сообщения](Admin_UpdateResult.htm)
		 о том, что невозможно обновить следующие объекты, используемые
		 контейнером моделирования:


			- база данных.
			 Замените её на базу данных, созданную в обновляемом репозитории;


			- справочник единиц измерений
			 (UNITS). Замените его на справочник единиц измерения
			 из репозитория НСИ, созданного в обновляемом репозитории;


			- репозиторий НСИ.
			 Замените его на репозиторий НСИ, созданный в обновляемом репозитории.


	Примечание.
	 Всегда используйте указанные объекты для обновления.


	После выполнения последовательности шагов будет обновлен контейнер
	 моделирования и все его внутренние объекты.


## Обновление контейнера моделирования, использующего в качестве
 источника данных базу данных временных рядов


Если контейнер моделирования использует в качестве источника данных
 базу данных временных рядов или модели в данном контейнере используют
 данные из базы данных временных рядов, то для корректного обновления контейнера
 моделирования нужно обновить и используемые в нём базы данных временных
 рядов.


[![](Opened.gif)![](Closed.gif)Порядок шагов
 для корректного обновления](javascript:TextPopup(this))


		- Если в обновляемом репозитории никогда не создавали репозиторий
		 НСИ, то [создайте
		 репозиторий НСИ](Setup.chm::/05_RepoMngr/Setup_repoMngr_CreateRDSRepo.htm) с помощью менеджера репозитория.


		- С помощью [навигатора
		 объектов](GetStarted.chm::/Interface/Interface_Navigator.htm) в обновляемом репозитории создайте:


		-


			- [базу
			 данных](UiNavObj.chm::/database/UiDb_database.htm);


			- [репозиторий
			 НСИ](UiNavObj.chm::/repository_RDS/RepositoryRDS.htm), использующий созданную БД;


			- [справочники
			 НСИ](UiNavObj.chm::/reference_book/Master_RDS_reference_book/Master_RDS.htm). Созданные справочники должны быть
			 аналогичны по структуре справочникам, входящим в базы данных
			 временных рядов, которые использует контейнер моделирования;


			- [базу
			 данных временных рядов](UiNavObj.chm::/TimeSeriesDatabase/CreateTimeSeriesDatabase.htm), использующую созданный
			 репозиторий НСИ.


		- Откройте репозиторий, содержащий требуемый контейнер моделирования.


		- [Создайте обновление](CreateUpdate/Admin_CreateUpdate.htm)
		 и [добавьте](CreateUpdate/Admin_CreateUpdate_AddObjects.htm)
		 в него контейнер моделирования со всеми вложенными объектами и
		 все используемые базы данных временных рядов.


		- С помощью менеджера обновлений выстроите объекты созданного
		 обновления в порядке зависимости.


		- Установите необходимые параметры обновления: тип, способ,
		 условие обновления и другие параметры.


		- [Сохраните
		 обновление в файл](SaveUpdate/Admin_SaveUpdate.htm#in_file).


		- Откройте обновляемый репозиторий и запустите [установку
		 обновления](Admin_UpMBObj_DoUpdate.htm) из созданного файла.


		- В процессе обновления будут отображены [сообщения](Admin_UpdateResult.htm)
		 о том, что невозможно обновить следующие объекты, используемые
		 контейнером моделирования:


			- база данных.
			 Замените её на базу данных, созданную в обновляемом репозитории;


			- справочник единиц измерений
			 (UNITS). Замените его на справочник единиц измерения
			 из репозитория НСИ, созданного в обновляемом репозитории;


			- справочники НСИ, используемые
			 базами данных временных рядов. Замените их на аналогичные
			 справочники НСИ, созданные в обновляемом репозитории;


			- репозиторий НСИ.
			 Замените его на репозиторий НСИ, созданный в обновляемом репозитории;


			- справочник мер (MEASURES).
			 Замените его на справочник мер из репозитория НСИ, созданного
			 в обновляемом репозитории.


	Примечание.
	 Всегда используйте указанные объекты для обновления.


	После выполнения последовательности шагов будет обновлен контейнер
	 моделирования и используемые в нём базы данных временных рядов.


## Обновление справочников НСИ


Если файл обновления не включает репозиторий НСИ, то при переносе справочников,
 которые находились внутри репозитория, необходимо:


	- при переносе по ключам справочников ключи «репозитория НСИ»-источника
	 и «репозитория НСИ»-приёмника должны совпадать;


	- при переносе по идентификаторам справочников идентификаторы
	 «репозитория НСИ»-источника и «репозитория НСИ»-приёмника должны совпадать.


При переносе справочника НСИ у дочерних объектов справочника (таблиц
 и процедур) будут сгенерированы новые ключи, отличающиеся от ключей в
 репозитории источнике.


[![](Opened.gif)![](Closed.gif)Возможные ситуации
 при обновлении справочников НСИ, атрибуты которых ссылаются на объекты
 репозитория](javascript:TextPopup(this))


		- В обновление были добавлены все связанные объекты. Обновление
		 проходит корректно.


		- В обновление были добавлены не все связанные объекты и в
		 приёмнике не обнаружены объекты с указанными ключами. Выполняется
		 проверка, допускается ли пустое значение для ссылочного атрибута
		 справочника НСИ:


			- для атрибутов справочника НСИ, допускающих пустое значение,
			 записывается пустое значение;


			- для атрибутов справочника НСИ, не допускающих пустого
			 значения, обновление справочника прерывается и выдаётся ошибка
			 о том, что атрибут не допускает пустых значений.


		- В обновление были добавлены не все связанные объекты, но
		 в приёмнике:


			- находится соответствие
			 по ключам с объектами в репозитории. Справочник НСИ
			 обновляется корректно, привязываясь к существующим объектам;


			- не находится соответствие
			 по ключам между объектами и связанными объектами, которые
			 не были включены в обновление. Будет отображен диалог
			 для замены отсутствующего объекта. Если пользователь:


				- соглашается заменить объект. Будет необходимо выбрать
				 соответствующий объект в репозитории. Связь в справочнике
				 НСИ настраивается на выбранный объект;


				- отказывается заменить объект. Для атрибутов, допускающих
				 пустое значение, устанавливается значение NULL. Для атрибутов,
				 не допускающих пустое значение, выдаётся ошибка о том,
				 что атрибут не допускает пустых значений.


## Обновление базы данных временных рядов


При обновлении существующей базы данных временных рядов обновление метаданных
 объекта не доступно.


Метаданные объекта задаются только при создании новой базы данных временных
 рядов.


Для существующей базы данных временных рядов доступно только добавление/обновление
 данных при идентичности структуры данных.


## Обновление модели данных


При добавлении в обновление [модели данных](uidashboard.chm::/DataModel/create_data_model.htm)
 в обновление добавляются все объекты, из которых состоит модель данных.


Если модель данных использует подключение к серверу ClickHouse:


	- файлом обновления переносятся только структуры объектов:


		- таблиц и запросов в репозиторий, использующий подключение
		 к продукту «Форсайт. Аналитическая платформа»;


		- таблиц в репозиторий, использующий подключение к ClickHouse;


	- после установки обновления:


		- для таблиц модели данных, источниками которой являются плоские
		 файлы формата .xlsx и .csv, выполните [перезагрузку
		 файлов](uidashboard.chm::/DataModel/data_model_workspace_features.htm#refresh);


		- для таблиц модели данных, источниками которой являются не
		 плоские файлы, запустится материализация, если переключатель «Автообновление»
		 находится в активном состоянии.


Если модель данных используется в качестве источника данных [информационной
 панели](uidashboard.chm::/InformationPanel/Starting.htm) в режиме [извлечения
 данных](uidashboard.chm::/DataModel/data_modes.htm#extract), то после переноса информационной панели между
 репозиториями [обновите
 модель данных](uidashboard.chm::/DataModel/data_modes.htm#manual_update) перед первым сохранением информационной
 панели.


См. также:


[Установка обновления](Admin_UpMBObj_DoUpdate.htm)
 | [Процесс обновления](Admin_UpMBObj_DoUpdateFile.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
