# Редактирование и сохранение данных

Редактирование и сохранение данных
-


# Редактирование и сохранение данных


## Редактирование данных


Для перехода в режим редактирования дважды щёлкните по содержимому ячейки
 с данными. В инструменте «Аналитические
 панели» требуется предварительно разрешить редактирование данных.
 Для этого установите флажок «Редактирование
 данных» на вкладке «[Документ](UiAdhoc.chm::/Document/Document.htm)»,
 расположенной на боковой панели.


Примечание.
 Если источником данных является [куб](UiNavObj.chm::/Cube/CreateCube/Master_Standart/UiMd_Cube_CreateCube_Master_Standart_2.htm),
 построенный с использованием справочника НСИ, имеющего атрибуты со [множественными
 значениями](UiNavObj.chm::/reference_book/Master_RDS_reference_book/Attributes/Attribute.htm#multiple_values), то при переходе к редактированию в ячейках
 со множественным значением будет отображено значение «Массив».
 Сохранить можно только значения ключа элементов, которые есть в связанном
 справочнике.


Для редактирования содержимого ячейки используйте команды контекстного
 меню или сочетания клавиш:


	- Вырезать (CTRL+X). Вырезает
	 содержимое ячейки в буфер обмена;


	- Копировать (CTRL+C).
	 Копирует содержимое ячейки в буфер обмена;


	- Вставить (CTRL+V). Вставляет
	 данные из буфера обмена;


	- Удалить (DELETE). Удаляет
	 данные из ячейки таблицы.


В инструменте «Аналитические панели»
 для редактирования доступны только сочетания клавиш.


Совет. Для ячеек
 с изменёнными данными можно изменить настройки [шрифта](../TableView/Formatting/Font_settings.htm),
 [заливки](../TableView/Formatting/formattingColor.htm), [границ](../TableView/Formatting/formattingBorders.htm) и
 [формата данных](../TableView/Formatting/Data_format.htm) на
 вкладке боковой панели «[Оформление измененных
 данных](../TableView/Formatting/Format_changed_data.htm)».


Невозможно редактирование значений, которые нельзя записать в источник:


	- вычисляемые элементы;


	- итоги по строкам, по столбцам;


	- агрегированные данные;


	- данные вычисляемого источника, если не задан альтернативный
	 куб для сохранения данных.


Для визуализации отсутствия возможности редактирования ячеек доступно
 включение отображения пиктограмм.
 Для получения подробной информации обратитесь к статье «[Отображение пиктограмм
 в ячейках](../TableView/Formatting/Cells_icons.htm)».


### Особенности отображения значений в агрегированных
 ячейках


Доступно для регламентного отчёта и экспресс-отчёта.


Если в качестве источника данных использован куб с настроенной агрегацией,
 установленным флажком «[Не агрегировать разные единицы измерения](uinavobj.chm::/Cube/CreateCube/Master_Standart/UiMd_Cube_CreateCube_Master_Standart_7.htm#no_agr)»,
 и при этом отмечены элементы с разными единицами измерений, то в агрегированой
 ячейке вместо значения будет выведен символ «-». Для изменения символа
 или вывода текста используйте свойство [IPivot.UnmatchedUnitsText](kepivot.chm::/Interface/IPivot/IPivot.UnmatchedUnitsText.htm).


Символ также отображается для:


	- регламентного отчёта при [расчёте
	 итоговых значений](uireport.chm::/web/Reports/OperationReport/totals.htm#symbol), [агрегации
	 фиксированных измерений](uireport.chm::/web/Table/Attribute/Format_Data.htm#symbol);


	- экспресс-отчёта при [расчёте
	 итоговых значений](../Totals/Calculate_totals.htm#symbol), [агрегации
	 фиксированных измерений](UiExpress.chm::/Setup_express_report/UiExpress_control.htm#symbol).


При включении [отображения
 пиктограмм](../TableView/Formatting/Cells_icons.htm)[ для
 вычисляемых ячеек](../TableView/Formatting/Cells_icons.htm#pic) в агрегированой ячейке одновременно будет выведено
 оба символа. По умолчанию «=-».


### Особенности редактирования при использовании автофильтра


При редактировании данных в инструментах «Аналитические
 панели» и «Аналитические запросы
 (OLAP)» в веб-приложении учитывайте следующие особенности при использовании
 [автофильтра](Filtering.htm):


	- удаление данных применяется только к видимым строкам/столбцам;


	- вставка значения из одной ячейки в диапазон ячеек выполняется
	 только в видимые строки/столбцы;


	- вставка диапазона значений применяется ко всем видимым строкам/столбцам.
	 Вставляемый диапазон значений расширяется с учётом размера области
	 копирования, в том числе на скрытые строки/столбцы;


	- [перемещение диапазона значений в буфер
	 обмена](Insert.htm#cut) применяется ко всем строкам/столбцам независимо от их видимости
	 при фильтрации. [Копирование диапазона значений
	 в буфер обмена](Insert.htm#copy) применяется только к видимым строкам/столбцам.


Поведение будет одинаковым для всего диапазона данных независимо от
 расположения фильтра.


## Сохранение данных


Сохранение данных возможно, если пользователь имеет права на изменение
 данных.


### В экспресс-отчете


Для сохранения изменённых данных в источник:


	- Нажмите кнопку ![](saveData.png) «Сохранить
	 изменения» на вкладке ленты «Данные».


	- Будет выведено сообщение для подтверждения действия. Нажмите
	 кнопку «Да», чтобы новое значение
	 было сохранено в источнике данных. При нажатии на кнопку «Нет» значение будет отображаться
	 на листе отчёта, но не будет сохранено.


Важно.
 Сохранение изменённых данных доступно для стандартных кубов (кроме кубов,
 построенных на запросе), представлений-кубов и виртуальных кубов.


Для отмены несохранённых изменений и выхода из режима редактирования
 нажмите кнопку ![](revert.png)
 «Отменить изменения» на вкладке
 ленты «Данные».


Если были произведены какие-либо изменения данных, и они не были сохранены
 в источник, то при закрытии, обновлении или попытке сохранения отчёта
 будет предложено сохранить изменения.


[![](../opened.gif)![](../closed.gif)Возможные ошибки
 при сохранении данных](javascript:TextPopup(this))


		- Если в кубе используются единицы измерения, то при сохранении
		 в кубах происходит пересчёт введённых значений из указанных единиц
		 измерения в базовую (прописанную в справочнике показателей), и
		 сохранение в базу производится только в базовой единице измерения.
		 Если введены данные по разным единицам измерения и при пересчёте
		 в базовую получаются разные значения, будет выдано сообщение о
		 некорректности введённых данных;


		- При сохранении изменённых данных по вычисляемому факту будет
		 выдано сообщение о невозможности сохранения введённых данных,
		 если для факта не была определена обратная формула ([Вычисляемые
		 факты](UiNavObj.chm::/Cube/CreateCube/Master_Standart/UiMd_Cube_CreateCube_Master_Standart_5.htm));


		- При отсутствии прав на изменение данных в источнике будет
		 выдано сообщение о невозможности сохранения введённых данных.


### В аналитической панели


Для сохранения изменённых данных:


	- в выделенной таблице.
	 Нажмите кнопку ![](save_changes.gif) «Сохранить
	 изменения» на вкладке «Данные»
	 на боковой панели;


	- во всех таблицах аналитической
	 панели. Выполните команду ![](save_changes.gif) «Сохранить» в главном меню аналитической
	 панели или нажмите кнопку ![](save_changes.gif) «Сохранить
	 изменения» на вкладке «Главная»
	 боковой панели.


Данные будут сохранены в источник. Если в процессе сохранения данных
 возникла ошибка, то будет отображено соответствующее сообщение.


Для отмены несохранённых изменений в данных:


	- выделенной таблицы. Нажмите
	 кнопку ![](undo.png)
	 «Отменить изменения» на вкладке
	 «Данные» на боковой панели;


	- всех таблиц в аналитической
	 панели. Нажмите кнопку ![](undo.png) «Отменить
	 изменения» на вкладке «Главная»
	 на боковой панели.


Все несохранённые изменения будут отменены.


Если были произведены какие-либо изменения данных и они не были сохранены
 в источник, то при закрытии, обновлении или попытке сохранения аналитической
 панели будет предложено сохранить изменения.


Примечание.
 При изменении отметки, по которой строится таблица, все несохранённые
 данные будут потеряны.


[![](../opened.gif)![](../closed.gif)Возможные
 ошибки при сохранении данных](javascript:TextPopup(this))


		- При отсутствии прав на изменение данных в источнике будет
		 выдано сообщение о невозможности сохранения введённых данных.


### В регламентном отчете


Доступны следующие варианты сохранения данных в источник:


	- Сохранить данные отчета.
	 В источники данных будут сохранены изменённые значения всех таблиц
	 данных отчёта. Данный пункт будет недоступен, если ни одна из таблиц
	 данных отчёта не содержит изменённых значений;


	- Сохранить данные листа.
	 В источники данных будут сохранены изменённые значения всех таблиц
	 данных текущего листа отчёта. Данный пункт будет недоступен, если
	 текущий лист не содержит изменённых значений.


Примечание.
 Сохранение данных в источник доступно, если на вкладке «[Параметры](../Parameters/Parameters.htm)»
 боковой панели установлен флажок «Сохранять
 данные в источник».


Сохранение изменённых данных возможно в следующие виды источников: стандартный
 куб, представление-куб, виртуальный куб, переменные моделирования.


В зависимости от выбранного режима работы произведите действия для сохранения
 изменённых данных:


[![](../opened.gif)![](../closed.gif)В режиме редактирования](javascript:TextPopup(this))


	Для сохранения изменённых значений в источник (куб, переменная моделирования,
	 показатель) при работе с отчётом в режиме редактирования:


		- используйте кнопку ![](save_changes.gif) на панели быстрого
		 доступа. В меню кнопки выберите вариант сохранения;


		- нажмите кнопку ![](saveData.png)«Сохранить
		 данные» в группе «Сохранить»
		 на вкладке ленты «Данные».
		 В меню кнопки выберите вариант сохранения.


[![](../opened.gif)![](../closed.gif)В режиме просмотра](javascript:TextPopup(this))


	При работе с отчётом в режиме просмотра:


		- для сохранения изменённых данных нажмите кнопку ![](save_changes.gif) «Сохранить
		 изменения» на вкладке ленты «Главная».
		 При последующем открытии отчёта будут отображаться новые данные;


		- для отмены изменений нажмите кнопку ![](undo.png)
		 «Отменить изменения» на
		 вкладке ленты «Главная».


	Примечание.
	 Кнопки ![](save_changes.gif) «Сохранить
	 изменения» и ![](undo.png) «Отменить
	 изменения» доступны, если в ячейках таблицы были введены или
	 изменены данные.


Примечание.
 Действия по сохранению данных в источник будут доступны только после обновления
 отчёта.


Если были произведены какие-либо изменения данных и они не были сохранены
 в источник, то при закрытии, обновлении или попытке сохранения отчёта
 будет предложено сохранить изменения.


[![](../opened.gif)![](../closed.gif)Возможные ошибки
 при сохранении данных](javascript:TextPopup(this))


	Если при сохранении данных в источник возникнут ошибки, то будет
	 выдано сообщение, в котором:


		- нажатие кнопки «Продолжить»
		 приводит к продолжению сохранения данных с пропуском некорректного
		 значения;


		- нажатие кнопки «Прервать»
		 приводит к прерыванию процесса сохранения;


		- нажатие кнопки «Подробнее»
		 приводит к отображению дополнительной информации об ошибке;


		- флажок «Пропустить все
		 ошибки» позволяет продолжить сохранение с пропуском всех
		 некорректных данных, которые будут вызывать ошибки.


	Возможные причины ошибки:


		- в область данных вместо чисел был введен текст;


		- в области данных была указана недопустимая величина значения.


См. также:


[Работа
 с данными таблицы](Working_with_table_data.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
