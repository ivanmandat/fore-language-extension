# Приёмник данных «OLE DB»: Задача ETL, настольное приложение

Приёмник данных «OLE DB»: Задача ETL, настольное приложение
-


**


# OLE DB


	Коннектор «OLE DB» - объект,
	 предназначенный для экспорта данных в БД с использованием драйверов OLE DB**.


	После добавления коннектора на рабочее пространство задачи ETL задайте
	 базовые свойства и настройки экспорта. Также можно отредактировать вход,
    выход коннектора и задать параметры обработки ошибок.


## Базовые свойства


В базовых свойствах задаются наименование объекта, идентификатор и примечание.


## Настройка экспорта


	На странице «Настройка экспорта»
	 указываются параметры подключения для экспорта данных.


	![](../UiEtl_Outputs_OleDB.gif)


	В поле «Строка подключения»
	 задайте параметры подключения к источнику данных вручную или с помощью
	 специального диалога свойств канала передачи данных, для вызова которого
	 нажмите кнопку ![](../../../dots.gif). При автоматическом формировании строки
    подключения в поле добавляется [глобальная
	 переменная](UiNav.chm::/02_Navigator/UiNav_GlobalVariables.htm) %METABASE_OLEDBPARAMS%, которая предназначена
	 для хранения дополнительных параметров подключения.


	В комбинированном списке «Таблица»
	 выберите или введите наименование таблицы, которая будет приёмником данных.
     Если таблица не существует, то она будет создана после выполнения задачи
     ETL.


	Установка флажка «Очищать приёмник
	 перед загрузкой» позволяет удалить всю информация из приёмника
	 перед выполнением загрузки данных.


## Обработка ошибок


На странице «Обработка ошибок»
 определяется поведение объекта экспорта при возникновении ошибочных ситуаций.


Примечание.
 Страница является общей для всех коннекторов к приёмникам данных, кроме
 приёмников «[XML](../XML/UiEtl_outputs_XML.htm)», «[Текст](../Text/UiEtl_Outputs_Text.htm)»,
 «[JSON](../JSON/JSON_Outputs.htm)»
 и «[Приёмник пользователя](../User/UiEtl_Outputs_User.htm)». Рассмотрим
 настройку параметров для обработки ошибок на примере мастера редактирования
 приёмника данных «[Репозиторий](../Repositoriy/UiEtl_Outputs_Repo.htm)».


![](../../../Error_handling.PNG)


Если в настройках задачи ETL задан [обработчик
 событий](../../../06_CreateETL/Event_Handling.htm), то при возникновении ошибок будет генерироваться событие
 OnError. Также можно определить дальнейшее поведение объекта экспорта
 при возникновении ошибочных ситуаций:


	- Действие,
	 выполняемое при возникновении ошибочной ситуации. Выберите
	 в раскрывающемся списке действие, которое будет выполняться при возникновении
	 ошибок во время выгрузки данных:


		- Остановка расчёта задачи.
		 При возникновении ошибки экспорта будет полностью остановлено
		 выполнение задачи ETL;


		- Пропуск только некорректных
		 записей. При возникновении ошибки экспорта будут исключены
		 записи с ошибочными ситуациями. Используйте данное действие, когда
		 наличие всех записей некритично;


		- Пропуск всех записей в
		 рамках одной транзакции. При возникновении ошибки экспорта
		 будут исключены все записи той транзакции, в которой возникнет
		 ошибочная ситуация. Используйте данное действие, когда требуется
		 разделить весь объём записей на транзакции, в рамках которых необходимо
		 получение всех данных без исключения;


При выборе действий «Пропуск
 только некорректных записей» или «Пропуск
 всех записей в рамках одной транзакции» доступно указание файла
 для сохранения пропущенных записей.


	- Сохранить
	 пропущенные записи в файл. Укажите путь до файла для сохранения
	 пропущенных записей или выберите его с помощью кнопки «Обзор».
	 Если файл с указанным названием отсутствует, то он будет создан автоматически.

	Пропущенные записи будут сохранены в указанный файл, если для обработки
	 ошибок задачи установлено действие «Пропуск
	 только некорректных записей» или «Пропуск
	 всех записей в рамках одной транзакции». Перед загрузкой в
	 существующий файл данные в файле стираются.

	Параметры сохранения записей в файл:


		- кодировка: Unicode;


Примечание.
 Если при экспорте не было пропущенных записей, то в файл записывается
 текст «яю». Это означает пустой Unicode-файл в кодировке Win.


		- разделитель строк: {Возврат каретки}{Перевод строки};


		- разделитель полей: ; (точка с запятой);


		- ограничитель текста: "" (двойные кавычки).


Примечание.
 По умолчанию формируется следующее имя файла: «<идентификатор приёмника>_пропущенные
 записи.csv».


По каждой пропущенной записи в [журнале
 ETL](../../../04_Work/04_Jurnal/UiEtl_Jurnal.htm) создаётся отдельная запись, содержащая номер пропущенной записи,
 текст ошибки и информацию об ошибочном поле. Если были пропущены все записи
 в рамках транзакции из-за какой-либо одной ошибочной записи, то в журнале
 эта причина выводится в поле «Описание».


	- Остановить
	 выполнение при пропуске указанного числа записей. При необходимости
	 установите флажок и укажите пороговое количество ошибочных записей,
	 при превышении которого экспорт будет остановлен;


	- Количество записей, обрабатываемых
	 в одной транзакции. Укажите количество записей, которые будут
	 обрабатываться в рамках одной транзакции. Механизм транзакций рекомендуется
	 использовать для оптимизации времени, затрачиваемого на экспорт данных.
	 Все записи в рамках одной транзакции обрабатываются как единое целое:
	 если происходит ошибка при выгрузке хотя бы одной записи из транзакции,
	 то неуспешной будет вся транзакция. По умолчанию обрабатывается тысяча
	 записей.


Примечание.
 Если распределять записи по транзакциям не требуется, то укажите количество
 записей, равное нулю. В таком случае все записи из источника будут выгружаться
 по очереди. Данная настройка применяется только в том случае, если в раскрывающемся
 списке «Действие, выполняемое при возникновении
 ошибочной ситуации» выбрано действие «Остановка
 расчёта задачи» или «Пропуск только
 некорректных записей».


	- Вызвать событие, если произошла
	 ошибка. Установка флажка
	 позволяет выбрать пользовательское событие, которое будет генерироваться
	 при возникновении ошибки. В списке отображаются события, созданные
	 в [пользовательских
	 метаданных](UiDevEnv.chm::/04_NavigatorSetting/Classes_Object/Classes_Events.htm) репозитория. Отслеживание события осуществляется
	 в [планировщике
	 задач](UiAppSrv.chm::/UiAppSrv_purpose.htm),
	 задачи должны быть настроены на выполнение [по
	 наступлению настраиваемого события](UiAppSrv.chm::/3_Work_Tasks/UiAppSrv_Work_Tasks_CreateTask_TimeTable.htm#customevent).


После выполнения действий будет настроено поведение объекта экспорта
 при возникновении ошибочных ситуаций во время выгрузки данных.


## Редактирование входа


Для задания списка полей и связи для входа используйте страницу «Редактирование входа».


![](../../../Edit_input.PNG)


На странице доступны следующие параметры:


[![](../../../../Opened.gif)![](../../../../Closed.gif)Идентификатор](javascript:TextPopup(this))


	Укажите идентификатор входа редактируемого объекта. Возможно использование
	 символов латинского алфавита, цифр и специального символа «_».


[![](../../../../Opened.gif)![](../../../../Closed.gif)Связь с объектом](javascript:TextPopup(this))


	Установите связь с объектом. Для этого из раскрывающегося списка
	 выберите объект задачи ETL. Данные из объекта будут поступать на вход.


[![](../../../../Opened.gif)![](../../../../Closed.gif)Поля](javascript:TextPopup(this))


	Добавьте необходимые поля объекта задачи ETL в список. В указанные
	 поля будут выгружаться данные.


	Для добавления в список всех полей из связанного со входом объекта,
	 являющегося приёмником:


		- Нажмите кнопку «Заполнить
		 из».


		- В раскрывающемся меню кнопки выберите пункт «Из приёмника».


	Для добавления в список всех полей из связанного с выходом объекта,
	 являющегося источником:


		- Нажмите кнопку «Заполнить
		 из».


		- В раскрывающемся меню кнопки выберите пункт «Из
		 источника».


	Для добавления нового поля нажмите кнопку «Добавить».
	 Будет открыто окно для указания значения атрибутов поля:


	![](../../../Field_properties.PNG)


	Примечание.
	 Вид окна «Свойства поля» зависит
	 от выбранного источника данных.


	Задайте в нем значения атрибутов поля:


		- Идентификатор. Уникальный
		 идентификатор поля;


		- Наименование. Наименование
		 поля;


		- Тип данных. Из раскрывающегося
		 списка выберите тип данных поля;


		- Общая длина. Определите
		 общую длину поля. Доступно только для строкового и вещественного
		 типов данных;


		- Десятичных знаков.
		 Определите количество знаков после запятой. Доступно только для
		 вещественного типа данных;


		- Вычисляемое поле.
		 Для задания формулы, по которой будет вычисляться значение поля,
		 установите данный флажок. После установки флажка введите выражение
		 с помощью клавиатуры или [редактора выражений](UiNav.chm::/GUI/ExpressionEditor.htm),
		 который открывается при нажатии на кнопку ![](../../../dots.gif).

		Для увеличения значения каждой новой записи на фиксированную величину
		 используйте специальное выражение INCREMENT.


	Примечание.
	 Специальное выражение INCREMENT
	 доступно только для вычисляемого поля целого типа.


	Синтаксис данного выражения: INCREMENT[Value1,
	 Value2], где Value1 - начальное значение, Value2 - шаг, на который
	 значение Value1 должно увеличиваться при каждом вызове выражения.
	 При каждой загрузке данных заполнение будет начинаться с начального
	 значения.


	Для редактирования поля:


		- дважды щелкните по полю кнопкой мыши;


		- выделите необходимое поле и нажмите кнопку «Редактировать».


	Для удаления выбранного поля нажмите кнопку «Удалить».
	 Поле будет удалено без подтверждения выполняемого действия.


	Для перемещения поля, выделенного в списке, используйте кнопки ![](../../01_GeneralMastersPagers/UiEtl_EtlObj_EditInput_2.gif)
	 «Вверх» и ![](../../01_GeneralMastersPagers/UiEtl_EtlObj_EditInput_3.gif)
	 «Вниз».


Примечание.
 Скриншот сделан на примере мастера редактирования приёмника данных «Репозиторий».


## Редактирование выхода


На странице «Редактирование выхода»
 задаётся связь с объектом-приёмником, в который будут выгружаться данные
 при выполнении задачи ETL.


Примечание.
 Страница является общей для всех коннекторов и преобразователей данных,
 кроме преобразователей «[Разделение](../../04_Transformers/01_Split/uietl_split.htm)»
 и «[Алгоритм пользователя](../../04_Transformers/09_algorithm/UiEtl_Trfs_Algorithm.htm)». Рассмотрим
 настройку списка полей и связи выхода на примере мастера редактирования
 источника данных «[Репозиторий](../../02_Inputs/UiEtl_Inputs_Repo.htm)».


![](../../../Edit_output.PNG)


На странице доступны следующие настройки:


[![](../../../../Opened.gif)![](../../../../Closed.gif)Идентификатор](javascript:TextPopup(this))


	Укажите идентификатор выхода редактируемого объекта. Возможно использование
	 символов латинского алфавита, цифр и специального символа «_».


[![](../../../../Opened.gif)![](../../../../Closed.gif)Связь с объектом](javascript:TextPopup(this))


	Установите связь с объектом-приёмником, в который будут выгружаться
	 данные. Для этого из раскрывающегося списка выберите объект задачи
	 ETL.


[![](../../../../Opened.gif)![](../../../../Closed.gif)Поля](javascript:TextPopup(this))


	Поля объекта-приёмника, в которые будут выгружаться данные, предназначены
	 для определения формата вывода данных.


	Примечание.
	 Редактирование списка полей доступно только для коннекторов к источнику
	 данных. Для коннекторов к приёмнику данных список полей заполняется
	 автоматически.


	Для добавления в список всех полей из связанного объекта-приёмника:


		- Нажмите кнопку «Заполнить
		 из».


		- В раскрывающемся меню кнопки выберите пункт «Из приёмника».


	После выполнения действий в список полей будут добавлены все поля
	 из связанного объекта-приёмника данных.


	Для добавления в список всех полей из связанного объекта-источника:


		- Нажмите кнопку «Заполнить
		 из».


		- В раскрывающемся меню кнопки выберите пункт «Из
		 источника».


	После выполнения действий в список полей будут добавлены все поля
	 из связанного объекта-источника данных.


	Для добавления нового поля:


		- Нажмите кнопку «Добавить».
		 Будет открыто окно «Свойства
		 поля»:


	![](../../../Field_properties.PNG)


		- Задайте в открывшемся окне значения атрибутов поля:


			- Идентификатор.
			 Укажите уникальный идентификатор поля. По умолчанию FIELD<Порядковый номер поля>;


			- Наименование.
			 Укажите наименование поля. По умолчанию FIELD<Порядковый
			 номер поля>;


			- Тип. Из раскрывающегося
			 списка выберите тип данных поля: строковый, целый, вещественный,
			 дата, текстовый. По умолчанию установлен строковый тип данных;


			- Вычисляемое поле.
			 Установите данный флажок для задания формулы, по которой будет
			 вычисляться значение поля. После установки флажка введите
			 выражение с помощью клавиатуры или [редактора выражений](UiNav.chm::/GUI/ExpressionEditor.htm),
			 который открывается при нажатии на кнопку ![](../../../dots.gif)
			 «Обзор».

			Для увеличения значения каждой новой записи на фиксированную
			 величину используйте специальное выражение INCREMENT.


	Примечание.
	 Специальное выражение INCREMENT
	 доступно только для вычисляемого поля целого типа.


	Синтаксис данного выражения: INCREMENT[Value1,
	 Value2], где Value1 - начальное значение, Value2 - шаг, на который
	 значение Value1 должно увеличиваться при каждом вызове выражения.
	 При каждой загрузке данных заполнение будет начинаться с начального
	 значения.


		- Нажмите кнопку «ОК».


	После выполнения действий будет добавлено новое поле.


	Для редактирования поля:


		- дважды щёлкните по полю кнопкой мыши;


		- выделите необходимое поле и нажмите кнопку «Редактировать».


	После выполнения действий будет открыто окно «Свойства
	 поля», приведённое выше.


	Для удаления выбранного поля нажмите кнопку «Удалить».
	 Поле будет удалено без подтверждения выполняемого действия.


	Для изменения порядка выгрузки данных в коннектор выделите необходимое
	 поле и переместите его в списке полей с помощью кнопок ![](../../01_GeneralMastersPagers/UiEtl_EtlObj_EditInput_2.gif)
	 «Вверх» и ![](../../01_GeneralMastersPagers/UiEtl_EtlObj_EditInput_3.gif)
	 «Вниз».


См. также:


[Начало
 работы с инструментом «Задача ETL» в веб-приложении](../../../../Web/01_General_Info/UiETL_StartingToWork.htm) | [Приёмники данных](../UiEtl_Outputs.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
