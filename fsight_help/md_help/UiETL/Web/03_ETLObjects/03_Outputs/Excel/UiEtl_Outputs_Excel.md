# Коннектор к приёмнику данных «Excel»: Задача ETL, веб-приложение

Коннектор к приёмнику данных «Excel»: Задача ETL, веб-приложение
-


# Excel


	Коннектор «Excel» - объект,
	 предназначенный для экспорта данных в файлы формата Microsoft Excel
	 (*.xls или *.xlsx).


	После добавления коннектора на рабочее пространство задачи ETL задайте
	 [настройки экспорта](#export) и отредактируйте [вход](#input)
	 и [выход](#output) коннектора.


## Настройка экспорта


	На панели свойств можно выбрать вариант сохранения полученного при
	 экспорте файла и задать параметры экспорта данных.


[![](../../../../Opened.gif)![](../../../../Closed.gif)Для отображения
 панели свойств](javascript:TextPopup(this))


		- добавьте новый коннектор на рабочую область. Панель свойств
		 отобразится автоматически;


		- выделите готовый коннектор на рабочей области.


	![](Page_Export_Settings.png)


	Для настройки доступны следующие параметры:


	- Имя объекта. При необходимости
	 измените наименование коннектора;


	- Идентификатор. При необходимости
	 измените идентификатор объекта. Идентификатор должен быть уникальным в рамках задачи ETL. Допускается использование
	 букв латинского алфавита, цифр и знаков «_». Идентификатор должен
	 начинаться с буквы;


	- Примечание. При необходимости
	 введите аннотацию к объекту. Примечание может содержать любую информацию по
	 усмотрению пользователя;


	- Операция над готовым файлом.
	 Выберите, куда будет отправлен файл после экспорта данных:


		- Загрузить
		 по выполнению в браузер. По умолчанию переключатель выключен.
		 Для открытия файла в браузере после экспорта включите переключатель;


		- По
		 указанному пути. По умолчанию переключатель включен. В
		 соответствующем поле задайте путь и наименование файла, в который
		 будут экспортироваться данные;


		- Создать лист. Задайте
		 наименование листа, который будет создан в файле и на который
		 будет производиться экспорт данных;


		- Записать заголовки полей.
		 По умолчанию флажок установлен. При экспорте в первую строку файла
		 будут выведены заголовки столбцов. Для выведения в первую строку
		 экспортированных данных снимите флажок;


		- Очищать приёмник перед
		 загрузкой. По умолчанию флажок установлен. Перед выполнением
		 загрузки вся информация из приёмника удаляется;


Если в настройках задачи ETL задан [обработчик
 событий](../../../06_CreateETL/Event_Handling.htm), то при возникновении ошибок будет генерироваться событие
 OnError. Также можно определить дальнейшее поведение объекта экспорта
 при возникновении ошибочных ситуаций:


	- Действие, выполняемое при возникновении
	 ошибочной ситуации. Выберите действие, выполняемое при возникновении
	 ошибок во время выгрузки данных:


		- Остановка
		 расчёта задачи. При возникновении ошибки экспорта будет
		 полностью остановлено выполнение задачи ETL;


		- Пропуск
		 только некорректных записей. Исключаются некорректные записи.
		 Данный пункт нужно выбирать в случае, когда наличие всех записей
		 некритично;


		- Пропуск
		 всех записей в рамках одной транзакции. Исключаются все
		 записи той транзакции, в которой возникнет ошибочная ситуация.
		 Данный пункт нужно выбирать в случае, когда необходимо разделить
		 весь объем записей на транзакции, в рамках которых необходимо
		 получение всех данных без исключения.


При выборе действий «Остановка
 расчёта задачи» или «Пропуск только
 некорректных записей» будет происходить разделение задачи на транзакции,
 а указанное количество записей будет влиять на скорость выполнения задачи;


	- Экспорт ошибок. По умолчанию
	 флажок снят, ошибки, возникшие при выполнении задачи ETL, не экспортируются.
	 При установке флажка выберите, куда будет отправляться информация
	 об ошибках:


		- Загрузить по выполнению
		 в браузер. После экспорта в браузере будет открыта страница
		 со списком ошибок;


		- По указанному пути.
		 Задайте путь и наименование файла, в который будет экспортироваться
		 список ошибок;


	- Остановить выполнение при пропуске
	 указанного числа записей.
	 По умолчанию флажок снят.
	 Для остановки выполнения задачи ETL установите флажок и укажите
	 пороговое количество ошибочных записей, при превышении которого экспорт
	 будет остановлен;


	- Количество записей, обрабатываемых
	 в одной транзакции. Укажите количество записей, обрабатываемых
	 в рамках одной транзакции в соответствующем поле. По умолчанию обрабатывается
	 1024 записи;


	- Вызвать событие, если произошла
	 ошибка. Позволяет выбрать пользовательское событие, которое
	 будет генерироваться при возникновении ошибки. В списке отображаются
	 события, созданные в [пользовательских
	 метаданных](UiDevEnv.chm::/04_NavigatorSetting/Classes_Object/Classes_Events.htm) репозитория. Отслеживание события осуществляется
	 в [планировщике
	 задач](UiAppSrv.chm::/UiAppSrv_purpose.htm),
	 задачи должны быть настроены на выполнение [по
	 наступлению настраиваемого события](UiAppSrv.chm::/3_Work_Tasks/UiAppSrv_Work_Tasks_CreateTask_TimeTable.htm#customevent).


		- Настройки. Кнопка
		 позволяет перейти к редактированию [входа](#input)
		 и [выхода](#output) коннектора.


## Редактирование входа


Для задания списка полей и связи для входа перейдите на вкладку «Редактор входов».


[![](../../../../Opened.gif)![](../../../../Closed.gif)Для отображения
 вкладки редактирования входов](javascript:TextPopup(this))


		- Откройте панель свойств объекта.


		- Нажмите кнопку ![](../../04_Transformers/02_Union/button_settings.png) «Настройки».


		- На панели дополнительных настроек объекта перейдите на вкладку
		 «Редактор входов».


![](../../../Edit_input.PNG)


На странице доступны следующие настройки:


[![](../../../../Opened.gif)![](../../../../Closed.gif)Идентификатор](javascript:TextPopup(this))


	Для изменения идентификатора входа дважды щёлкните в его области
	 и задайте новое значение. Возможно использование символов латинского
	 алфавита, цифр и специального символа «_». По умолчанию идентификаторы
	 входов объектов генерируются автоматически в формате: I<номер
	 входа>.


[![](../../../../Opened.gif)![](../../../../Closed.gif)Связь с объектом](javascript:TextPopup(this))


	Установите связь с объектом. Для этого нажмите кнопку ![](../../../btn_link.png) «Создать
	 связь» и выберите выход какого-либо
	 объекта. Если список полей источника и приёмника полностью совпадает,
	 то все поля будут связаны автоматически. Также связь полей может быть
	 настроена в группе настроек «[Настройка
	 связей](../../05_Links/uietl_links_create.htm)».


[![](../../../../Opened.gif)![](../../../../Closed.gif)Поля](javascript:TextPopup(this))


	Добавьте необходимые поля объекта задачи ETL в список. В указанные
	 поля будут выгружаться данные. Для добавления в список всех полей
	 из связанного с входом объекта, являющегося приёмником, нажмите кнопку
	 ![](../../../btn_menu.png)
	 «Действия» и выполните команду
	 «Заполнить из приёмника».


## Редактирование выхода


[![](../../../../Opened.gif)![](../../../../Closed.gif)Для отображения
 вкладки редактирования выходов](javascript:TextPopup(this))


		- Откройте панель свойств объекта.


		- Нажмите кнопку ![](../../04_Transformers/02_Union/button_settings.png) «Настройки».


		- На панели дополнительных настроек объекта перейдите на вкладку
		 «Редактор выходов».


![](../../../Edit_output.PNG)


На странице доступны следующие настройки:


[![](../../../../Opened.gif)![](../../../../Closed.gif)Идентификатор](javascript:TextPopup(this))


	Для изменения идентификатора выхода дважды щёлкните в его области
	 и задайте новое значение. Возможно использование символов латинского
	 алфавита, цифр и специального символа «_». По умолчанию идентификаторы
	 выходов объектов генерируются автоматически в формате: O<номер
	 выхода>.


[![](../../../../Opened.gif)![](../../../../Closed.gif)Связь с объектом](javascript:TextPopup(this))


	Установите связь с объектом. Для этого нажмите кнопку ![](../../../btn_link.png) «Создать
	 связь» и выберите вход какого-либо
	 объекта. Если список полей источника и приёмника полностью совпадает,
	 то все поля будут связаны автоматически. Также связь полей может быть
	 настроена в группе настроек «[Настройка
	 связей](../../05_Links/uietl_links_create.htm)».


[![](../../../../Opened.gif)![](../../../../Closed.gif)Поля](javascript:TextPopup(this))


	Добавьте необходимые поля объекта задачи ETL в список. Из указанных
	 полей будут выгружаться данные.


	Для добавления в список всех полей из файла-источника, нажмите кнопку
	 ![](../../../btn_menu.png)
	 «Действия» и выполните команду
	 «Заполнить из источника».


	Для добавления нового поля нажмите кнопку ![](../../../btn_add_field.png)
	 «Добавить». Будет открыто
	 окно «Свойства поля»:


	![](../../../Field_properties.PNG)


	Примечание.
	 Вид окна «Свойства поля» зависит
	 от выбранного источника данных.


	Задайте в нем значения атрибутов поля:


		- Наименование. Наименование
		 поля;


		- Идентификатор. Уникальный
		 идентификатор поля;


		- Тип. Из раскрывающегося
		 списка выберите тип данных поля;


		- Вычисляемое поле.
		 Для задания формулы, по которой будет вычисляться значение поля,
		 установите данный флажок. После установки флажка введите выражение
		 с помощью клавиатуры.

		Для увеличения значения каждой новой записи на фиксированную величину
		 используйте специальное выражение INCREMENT.


	Примечание.
	 Специальное выражение INCREMENT
	 доступно только для вычисляемого поля целого типа.


	Синтаксис данного выражения: INCREMENT[Value1,
	 Value2], где Value1 - начальное значение, Value2 - шаг, на который
	 значение Value1 должно увеличиваться при каждом вызове выражения.
	 При каждой загрузке данных заполнение будет начинаться с начального
	 значения.


	Для редактирования поля выполните для него команду контекстного
	 меню «Редактировать».


См. также:


[Создание коннекторов к приёмнику данных](../UiEtl_Outputs.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
