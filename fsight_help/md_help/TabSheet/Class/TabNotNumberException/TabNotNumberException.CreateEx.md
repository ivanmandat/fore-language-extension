# TabNotNumberException.CreateEx

TabNotNumberException.CreateEx
-


# TabNotNumberException.CreateEx


## Синтаксис


CreateEx;


## Описание


Конструктор CreateEx создает
 экземпляр ошибки с текстом «#ЗНАЧ!».


## Комментарии


Данный конструктор предназначен для создания экземпляра ошибки с текстом
 «#ЗНАЧ!». Текст сообщения локализован в системных ресурсах продукта «Форсайт. Аналитическая платформа»,
 поэтому сообщение, возвращаемое в свойстве [IException.Message](ForeSys.chm::/Interface/IException/IException.Message.htm)
 будет зависеть от используемого в текущий момент языка интерфейса аналитической
 платформы.


## Пример


Для выполнения примера в репозитории предполагается наличие регламентного
 отчёта с подключенным модулем. В ячейку добавьте ссылку вида:


=<идентификатор модуля>.<наименование функции>(значение
 первого параметра, значение второго параметра)


В качестве значения параметра можно указать как само значение, так и
 адрес ячейки со значением.


Например:


=TABNOTNUMBEREXCEPTION_CREATEEX.Test(A0,B0)


где:


	- TABNOTNUMBEREXCEPTION_CREATEEX.
	 Идентификатор модуля;


	- Test. Наименование функции;


	- A0, B0.
	 Адреса ячеек со значениями параметров.


Добавьте ссылку на системную сборку Tab.


			Public Function Test(A, B: Variant): Variant;

Begin

    If A.VarType <> B.VarType Then

        Raise New TabNotNumberException.CreateEx;

    Else

        Return A + B;

    End If;

End Function Test;


Данный пример является макросом для регламентного отчета. При выполнении
 макроса осуществляется проверка типов передаваемых параметров. Если типы
 одинаковые, то функция возвращает сумму значений параметров. Если типы
 разные, то функция генерирует исключительную ситуацию. При возникновении
 исключительной ситуации в ячейке таблицы будет отображаться текст ошибки.
 Если в «Форсайт. Аналитическая платформа»
 используется русский язык, то текст будет «#ЗНАЧ!», если английский язык
 - «#VAL!» и т.д.


См. также:


[TabNotNumberException](TabNotNumberException.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
