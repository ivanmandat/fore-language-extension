# Настройка алгоритмов расчёта

Настройка алгоритмов расчёта
-


# Настройка алгоритмов расчёта


	Для расчёта и контроля данных табличной области используйте созданные
	 [алгоритмы
	 расчёта](CalculationAlgorithm.chm::/Purpose.htm).


	Примечание.
	 Выбор алгоритма расчёта доступен только при наличии установленного
	 расширения «[Алгоритмы расчёта](CalculationAlgorithm.chm::/Purpose.htm)».


	Для выбора алгоритмов расчёта используйте окно «Алгоритмы
	 расчёта»:


	[![](../../opened.gif)![](../../closed.gif)Для вызова
	 окна](javascript:TextPopup(this))


		Для вызова окна «Алгоритмы
		 расчёта» нажмите кнопку ![](display_params.png) «Алгоритмы расчета» в области
		 «Источники данных» редактора
		 табличной области.


	![](areatable_calculationalgorithm.png)


	[![](../../opened.gif)![](../../closed.gif)Элементы
	 окна «Алгоритмы расчёта»](javascript:TextPopup(this))


			- Выбранные алгоритмы
			 расчета. Содержит вкладки «На
			 изменение» и «На сохранение»,
			 отображающие списки добавленных алгоритмов с доступными настройками
			 на панели инструментов;


			- Настройки выбранного
			 алгоритма. Содержит вкладки «Свойства
			 выбранного алгоритма», для настройки связи параметров
			 алгоритма и формы ввода, и «Привязка
			 к формам ввода», для детализации формул, используемых
			 в алгоритме расчёта;


			- [Панель
			 вкладок](../Starting/Starting.htm#elements). Содержит кнопки для выбора группы настроек,
			 отображаемых на боковой панели, в режиме редактирования.


	Для определения алгоритма расчёта:


		- [Добавьте](Calculation_Practices.htm#addalgorithm)
		 готовый алгоритм расчёта.


		- Настройте свойства выбранного алгоритма:


			- задайте [общие
			 настройки алгоритма](Calculation_Practices.htm#common);


			- настройте [связи
			 параметров алгоритма и формы](Calculation_Practices.htm#parameters).


	После настройки алгоритмов расчёта закройте редактор и завершите
	 создание табличной области, нажав кнопку «Добавить»,
	 при редактировании табличной области нажмите кнопку «Сохранить».


	После завершения настройки табличной области, если требуется, перейдите
	 к шагу:


		- [Настройка
		 редактора атрибута справочника](../Attribute/Attribute.htm);


		- [Настройка
		 параметров формы](../Parameters/Parameters.htm);


		- [Настройка
		 обработки событий формы](../Parameters/Links.htm);


		- [Настройка
		 оформления формы](../Common/Design.htm).


## Добавление, перемещение и удаление алгоритма
	 расчёта


	Для добавления алгоритмов:


		- Нажмите кнопку ![](DataSources.png) «Источники» на панели вкладок.
		 Откроется боковая панель «[Источники](Data_Sources.htm)».


		- Выберите вкладку «Алгоритмы».


		- Наведите курсор на нужный алгоритм. Курсор примет вид указателя
		 ![](HandMovig.png).
		 С помощью механизма Drag&Drop переместите алгоритм вкладку
		 в зависимости от варианта выполнения расчета.


	В зависимости от варианта выполнения расчёта добавьте алгоритм на
	 вкладку:


		- На изменение. Алгоритмы,
		 добавленные на эту вкладку, будут выполнены непосредственно при
		 изменении данных в форме ввода. Расчёт производится в ячейках,
		 использующих в формулах изменённые данные. Значения в ячейках,
		 рассчитанные при помощи подключенного алгоритма расчета, отображаются
		 как изменённые данные;


		- На сохранение. Алгоритмы,
		 добавленные на эту вкладку, будут выполнены только при сохранении
		 данных в форме ввода, при изменении данных расчёт не производится.
		 Расчёт производится в источниках по всем данным.


	Для настройки очередности выполнения алгоритмов расчёта переместите
	 алгоритмы на вкладке с помощью механизма Drag&Drop.


	Для удаления выбранного алгоритма расчёта нажмите кнопку ![](../Common/Delete.png) «Удалить»
	 на панели инструментов вкладки.


## Настройка свойств выбранного алгоритма
	 расчёта


	Для настройки свойств выбранного алгоритма расчёта выделите его
	 в области «Выбранные алгоритмы расчёта».
	 В зависимости от типа алгоритма будут доступны различные настройки.
	 Тип алгоритма определяется автоматически. В таблице области «Выбранные алгоритмы расчёта» в столбце
	 «Тип» указан тип алгоритма
	 расчёта:


		- Расчет. Алгоритм
		 содержит только блоки расчёта. Можно добавить на вкладки «На изменение» и «На
		 сохранение»;


		- Контроль. Алгоритм
		 содержит только блоки контроля. Можно добавить только на вкладку
		 «На изменение»;


		- Расчет/Контроль.
		 Алгоритм содержит как расчетные блоки, так и блоки контроля. Можно
		 добавить на вкладки «На изменение»
		 и «На сохранение».


### Общие настройки алгоритма расчёта


	Выполните общие настройки алгоритма расчёта в области «Выбранные
	 алгоритмы расчёта»:


		- при необходимости снимите флажок напротив алгоритма в столбце
		 «Вкл» для проведения отладки
		 работы алгоритмов расчёта в форме ввода. По умолчанию флажки установлены
		 у всех алгоритмов;


		- установите флажок напротив алгоритма
		 в столбце «Сохранять данные»
		 для сохранения данных в источник. Доступно на вкладке «На
		 изменение». При установке флажка данные в ячейках, рассчитанные
		 алгоритмом, сохраняются в источник при [сохранении
		 данных](../Work/DataEnter.htm#datasave) или [сохранении
		 формы ввода](../Starting/ConstructForm.htm#save). Если данные в ячейках рассчитываются несколькими
		 алгоритмами, то сохраняются данные, рассчитанные последним алгоритмом
		 с включенной настройкой. Если флажок снят, то данные в ячейках,
		 рассчитанные алгоритмом, не сохраняются в источник, но сохраняются
		 в самой форме. Для отображения последних сохраненных данных источника
		 в ячейках, рассчитанных алгоритмом без сохранения данных, отключите
		 выполнение алгоритма или удалите его;


		- выберите из раскрывающегося списка «Область
		 расчёта» тип формирования области расчёта, который будет
		 использоваться при расчёте алгоритма:


			- пересечение отметок.
			 Для расчёта будет использовано пересечение отметки из алгоритма
			 по всем измерениям с отметкой в табличной области. Выбрано
			 по умолчанию;


			- период расчёта из алгоритма.
			 Для расчёта будет использовано пересечение отметки из алгоритма
			 по всем измерениям, кроме календарного, с отметкой в табличной
			 области;


			- вся отметка из алгоритма.
			 Для расчёта будет использована вся отметка из алгоритма без
			 учёта отметки в табличной области.


	Доступно на вкладке «На
	 изменение»;


		- установите флажок напротив алгоритма
		 в столбце «Расширять отметку»
		 для увеличения диапазона загружаемых данных, на основании отметки
		 указанной в алгоритме. Доступно на вкладке «На
		 изменение». При установке флажка в расчёте будут учитываться
		 все значения указанные при настройке алгоритма, а не только выводимые
		 в табличной области;


		- настройте обновление табличной области при сохранении данных.
		 Для этого нажмите кнопку ![](../Work/refreshAuto.png) «Автообновление» вкладки «Главная» панели инструментов.
		 Доступно для алгоритмов добавленных на вкладку «На
		 сохранение»;


		- настройте блокировку сохранения изменённых
		 данных в табличной области при сработавшем контроле. Для этого
		 нажмите кнопку ![](saveDataBlock.png) «Блокировать
		 сохранение измененных данных в табличной области при сработавшем
		 контроле». При [сохранении
		 измененных данных](../Work/DataEnter.htm#save) если хотя бы для одной табличной области
		 сработал контроль, будет выведено информационное сообщение, что
		 требуется корректировка введенных данных. При выполнении действий,
		 приводящих к обновлению табличной области: [сохранение](../Starting/ConstructForm.htm#save),
		 [обновление](../Common/Refresh.htm), [смена
		 значений параметров](../Work/UseControls.htm), закрытие формы ввода; [транспонирование](../Work/Transpose.htm)
		 и [редактирование](AreaTable.htm) табличной области -
		 будет выведено предупреждение, что измененные данные не будут
		 сохранены, так как не удовлетворяют настройкам контролей. При
		 отказе продолжить действие измененные данные останутся в табличной
		 области. Доступно при типе расчёта «Контроль»
		 на вкладке «На изменение».


### Настройка связи параметров алгоритма расчёта
	 и формы ввода


	Выполните настройку связи [параметров
	 алгоритмов расчёта](CalculationAlgorithm.chm::/web/Work/Set_up_calculation_parameters.htm) и [параметров
	 формы ввода](../Parameters/Parameters.htm) на вкладке «Свойства
	 выбранного алгоритма», установив:


		- Тип значения. Укажите
		 значения, которые используются при расчёте алгоритма:


			- Параметр формы.
			 В расчёте используется значение [параметра](../Parameters/Parameters.htm)
			 формы ввода;


			- Константное значение. В расчёте используется постоянное
			 значение;


		- Тип отметки. В зависимости
		 от выбранного типа значения:


			- если установлен тип «Параметр
			 формы», укажите тип отметки, выбрав его из раскрывающегося
			 списка. Допустимые значения: исходная, первый элемент, последний
			 элемент, исходная+дочерние, исходная+дочерние (рекурсивно),
			 дочерние, дочерние (рекурсивно);


			- если установлен тип «Константное
			 значение», тип отметки недоступен;


		- Схема справочника.
		 Выберите из раскрывающегося списка [схему
		 отметки](UiNavObj.chm::/reference_book/look-and-feel_Reference_book/UiMd_reference_book_look-and-feel_Scheme.htm) справочника, используемого в качестве
		 параметра алгоритма. Если у справочника не настроена схема отметки,
		 то список будет пустой;


	Примечание.
	 Схема отметки справочника имеет больший приоритет, чем тип отметки.


		- Значение. В зависимости
		 от выбранного типа значения:


			- если установлен тип «Параметр
			 формы», укажите параметр или атрибут параметра формы,
			 выбрав его из раскрывающегося списка;


			- если установлен тип «Константное
			 значение», задайте значение константы.


	Если алгоритм расчета и форма ввода построены на одном источнике,
	 то параметры алгоритма автоматически будут привязаны к параметрам
	 формы ввода. По умолчанию:


		- тип значения: Параметр формы;


		- тип отметки: Исходная;


		- схема справочника: не задана;


		- значение: параметр, построенный на этом же справочнике.


См. также:


[Построение
 формы ввода](../Starting/ConstructForm.htm) | [Работа с готовой
 формой ввода](../Work/FinishForm.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
