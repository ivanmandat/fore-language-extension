# Особенности хранения данных в базе данных временных рядов

Особенности хранения данных в базе данных временных рядов
-


# Особенности хранения данных в базе данных временных рядов


## Описание


	Для хранения данных база данных временных рядов использует несколько
	 дочерних системных метасправочников, расположенных в папке «Данные». Метасправочники создаются
	 автоматически при создании базы данных временных рядов.


	Получить доступ к данным метасправочникам можно из навигатора объектов
	 или с помощью языка Fore, используя методы [IRubricator.GetDictionary](KeCubes.chm::/Interface/IRubricator/IRubricator.GetDictionary.htm)
	 и [IRubricatorInstance.GetDictionary](KeCubes.chm::/Interface/IRubricatorInstance/IRubricatorInstance.GetDictionary.htm).


## Структура системных метасправочников


	Ниже приведена структура основных системных метасправочников, используемых
	 для хранения данных в базе данных временных рядов.


### Структура метасправочника фактов


	Метасправочник фактов содержит данные о временных рядах, присутствующих
	 в базе данных временных рядов.


	Наименование метасправочника формируется по следующей схеме: Факты_<наименование базы данных временных
	 рядов>. Например, в базе данных временных рядов «Статистика»
	 метасправочник временных рядов будет иметь наименование «Факты_Статистика».


	Метасправочник может содержать следующие типы атрибутов: системные
	 и пользовательские. Системные атрибуты создаются автоматически при
	 создании базы данных временных рядов. Пользовательские атрибуты создаются,
	 если пользователь создаёт дополнительные атрибуты временных рядов.


	Системные атрибуты метасправочника фактов:


			 Наименование атрибута
			 Описание


			 Ключ
			 Первичный ключ.


			Параметры атрибута:


				- Идентификатор атрибута: KEY;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Факт
			 Ключ временного ряда.


			Параметры атрибута:


				- Идентификатор атрибута: FACTOR;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Ревизия
			 Ключ ревизии.


			Параметры атрибута:


				- Идентификатор атрибута: REV;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Динамика
			 Календарная динамика временного ряда. Для определения
			 динамики используется перечисление [DimCalendarLevel](KeDims.chm::/Enums/DimCalendarLevel.htm).


			Параметры атрибута:


				- Идентификатор атрибута: DL;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.
				 Значение по умолчанию - «1».


			 Единица измерения
			 Единица измерения значений ряда.


			Параметры атрибута:


				- Идентификатор атрибута: UNIT;


				- Тип данных: Целый;


				- Особенности атрибута: Если единицы измерения являются
				 обязательным атрибутом ряда, то пустые значения не допускаются,
				 если единицы измерения не являются обязательным атрибутом
				 ряда, то пустые значения допускаются.


			 Объект
			 Ключ объекта репозитория, связанного с рядом. Значение
			 редактируется только с помощью Fore.


			Параметры атрибута:


				- Идентификатор атрибута: OBT;


				- Тип данных: Целый.


			 Мнемоника
			 Мнемоника временного ряда. Мнемоника - это уникальное
			 значение, генерируемое на основе значений атрибутов временного
			 ряда и используемое в качестве наименования ряда.


			Параметры атрибута:


				- Идентификатор атрибута: MNEMO;


				- Тип данных: Строковый;


				- Особенности атрибута: Пустые значения не допускаются.
				 По умолчанию длина 255 символов. Атрибут присутствует,
				 если при создании базы данных временных рядов указали,
				 что ряды имеют идентификатор.


			Атрибут может отсутствовать в
			 метасправочнике. Наличием/отсутствием атрибута управляет свойство
			 [IRubricator.HasMnemonics](KeCubes.chm::/Interface/IRubricator/IRubricator.HasMnemonics.htm).


			 Удален
			 Признак того, что временной ряд удален. Допустимые значения:


				- True. Ряд
				 присутствует в базе данных временных рядов;


				- False. По
				 умолчанию. Ряд удален.


			Параметры атрибута:


				- Идентификатор атрибута: DLT;


				- Тип данных: Логический;


				- Особенности атрибута: Пустые значения не допускаются.


			 Пуст
			 Признак того, что временной ряд имеет признак пустоты
			 и пустым считается ряд, не содержащий данных. Допустимые значения:


				- True. По
				 умолчанию. Ряд пустой;


				- False. Ряд
				 содержит данные.


			Параметры атрибута:


				- Идентификатор атрибута: EMPT;


				- Тип данных: Логический;


				- Особенности атрибута: Пустые значения не допускаются.
				 Атрибут присутствует, если при создании базы данных временных
				 рядов указали, что ряды имеют признак пустоты.


			Атрибут может отсутствовать в
			 метасправочнике. Наличием/отсутствием атрибута управляет свойство
			 [IRubricator.HasEmptyAttribute](KeCubes.chm::/Interface/IRubricator/IRubricator.HasEmptyAttribute.htm).


### Структура метасправочника значений временных рядов


	Метасправочник значений содержит значения наблюдений временных рядов.


	Наименование метасправочника формируется по следующей схеме: Значения_<наименование базы данных
	 временных рядов>. Например, в базе данных временных рядов
	 «Статистика» метасправочник
	 значений временных рядов будет иметь наименование «Значения_Статистика».


	Метасправочник может содержать следующие типы атрибутов: системные
	 и пользовательские. Системные атрибуты создаются автоматически при
	 создании базы данных временных рядов. Пользовательские атрибуты создаются,
	 если пользователь создаёт дополнительные атрибуты наблюдений.


	Системные атрибуты метасправочника значений временных рядов:


			 Наименование атрибута
			 Описание


			 Ключ
			 Первичный ключ.


			Параметры атрибута:


				- Идентификатор атрибута: KEY;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Факт
			 Ключ временного ряда, которому принадлежит наблюдение.


			Параметры атрибута:


				- Идентификатор атрибута: FACTOR;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Ревизия
			 Ключ ревизии, в которую было задано или изменено значение
			 наблюдение.


			Параметры атрибута:


				- Идентификатор атрибута: REV;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Динамика
			 Календарная динамика наблюдения. Для определения динамики
			 используется перечисление [DimCalendarLevel](KeDims.chm::/Enums/DimCalendarLevel.htm).


			Параметры атрибута:


				- Идентификатор атрибута: DL;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Дата
			 Дата, на которую задано значение наблюдения.


			Параметры атрибута:


				- Идентификатор атрибута: DT;


				- Тип данных: Дата;


				- Особенности атрибута: Пустые значения не допускаются.


			 Сценарий
			 Ключ сценария, которому принадлежит наблюдение. Если
			 значение «-1», то наблюдение принадлежит сценарию «Факт».


			Примечание.
			 Атрибут отсутствует, если база данных временных рядов не поддерживает
			 сценарии. Для получения подробной информации обратитесь к
			 описанию свойства [IRubricator.HasScenarioDimension](kecubes.chm::/Interface/IRubricator/IRubricator.HasScenarioDimension.htm).


			Параметры атрибута:


				- Идентификатор атрибута: SC;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.
				 Значение по умолчанию - «-1».


			 Значение
			 Значение наблюдения.


			Параметры атрибута:


				- Идентификатор атрибута: VL;


				- Тип данных: Вещественный;


				- Особенности атрибута: Общая длина - 30 знаков, количество
				 десятичных знаков - 8.


			 Примечание
			 Примечание к наблюдению.


			Параметры атрибута:


				- Идентификатор атрибута: CMT;


				- Тип данных: Строковый;


				- Особенности атрибута: По умолчанию длина 255 символов.


#### Особенности метасправочника значений


	Если база данных временных рядов использует базу данных на СУБД
	 MS SQL, то для атрибута «VL»
	 доступно снятие ограничения на общую длину знаков. Для этого нужно
	 использовать процедуру, приведенную ниже.


	Процедура приведена для базы данных временных рядов с идентификатором
	 «TSDB».


	Добавьте ссылки на системные сборки: Cubes, Metabase, Rds.


		Sub UserProc;

		Var

		    mb: IMetabase;

		    rub: IRubricator;

		    attr: IMetaAttribute;

		Begin

		    mb := MetabaseClass.Active;

		    rub := mb.ItemById("TSDB").Edit As IRubricator;

		    attr := rub.EditValues.Attributes.FindById("VL");

		    attr.FieldSize := 0;

		    rub.AlterAndSave;

		End Sub UserProc;


	В результате выполнения процедуры в базе данных временных рядов «TSDB»
	 для атрибута «VL» снято ограничение
	 на общую длину знаков.


	Важно.
	 Снятие ограничения на общую длину знаков выполняется за счет того,
	 что на уровне СУБД для атрибута устанавливается тип данных float.
	 Это приводит к потере точности после семнадцати знаков.


### Структура метасправочника ревизий


	Метасправочник ревизий содержит данных о ревизиях, выполненных в
	 базе данных временных рядов.


	Наименование метасправочника формируется по следующей схеме: Ревизии_<наименование базы данных временных
	 рядов>. Например, в базе данных временных рядов «Статистика»
	 метасправочник ревизий будет иметь наименование «Ревизии_Статистика».


			 Наименование атрибута
			 Описание


			 Ключ


			 Первичный ключ.


			Параметры атрибута:


				- Идентификатор атрибута: KEY;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Наименование


			 Наименование ревизии.


			Параметры атрибута:


				- Идентификатор атрибута: NAM;


				- Тип данных: Строковый;


				- Особенности атрибута: По умолчанию длина 255 символов.


			 Дата


			 Дата выполнения ревизии.


			Параметры атрибута:


				- Идентификатор атрибута: DT;


				- Тип данных: Дата.


			 Вид


			 Признак того, отображается ли данная ревизия в справочнике
			 ревизий. Допустимые значения:


				- 0. Ревизия
				 не отображается;


				- 1. Ревизия
				 отображается.


			Параметры атрибута:


				- Идентификатор атрибута: KIN;


				- Тип данных: Целый.


			 Пользователь


			 Пользователь, выполнивший ревизию.


			Параметры атрибута:


				- Идентификатор атрибута: USR;


				- Тип данных: Строковый;


				- Особенности атрибута: По умолчанию длина 255 символов.


			 Примечание


			 Примечание к выполнению ревизии.


			Параметры атрибута:


				- Идентификатор атрибута: CMT;


				- Тип данных: Строковый;


				- Особенности атрибута: По умолчанию длина 255 символов.


			 Объект


			 Ключ объекта репозитория, который инициировал появление
			 ревизии.


			Параметры атрибута:


				- Идентификатор атрибута: OBT;


				- Тип данных: Целый.


### Структура метасправочника выполнения правил валидации


	Метасправочник выполнения правил валидации содержит данные о правилах
	 валидации и группах правил валидации, выполненных в базе данных временных
	 рядов.


	Наименование метасправочника формируется по следующей схеме: Выполнения правил_<наименование базы
	 данных временных рядов>. Например, в базе данных временных
	 рядов «Статистика» метасправочник
	 ревизий будет иметь наименование «Выполнения
	 правил_Статистика».


			 Наименование атрибута
			 Описание


			 Ключ


			 Первичный ключ.


			Параметры атрибута:


				- Идентификатор атрибута: KEY;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Наименование


			 Наименование выполнения правила валидации.


			Параметры атрибута:


				- Идентификатор атрибута: NAM;


				- Тип данных: Строковый;


				- Особенности атрибута: По умолчанию длина 255 символов.


			 Ревизия


			 Ключ ревизии, в которой было выполнено правило.


			Параметры атрибута:


				- Идентификатор атрибута: REV;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Объект


			 Ключ правила валидации как объекта репозитория.


			Параметры атрибута:


				- Идентификатор атрибута: OBT;


				- Тип данных: Целый.


			 Дата


			 Дата выполнения правила валидации.


			Параметры атрибута:


				- Идентификатор атрибута: DT;


				- Тип данных: Дата.


			 Правило


			 Список ключей валидаций, входящих в рассчитанную группу
			 валидаций. Если рассчитывалась одна валидация, то только её
			 ключ.


			Параметры атрибута:


				- Идентификатор атрибута: CMT;


				- Тип данных: Целый.


			 Расчеты валидаций


			 Признак того, что валидация была рассчитана в по какому-либо
			 сценарию.


			Допустимые значения:


				- значение отсутствует.
				 Правило валидации не было рассчитано по сценарию;


				- 1. Правило
				 валидации рассчитано по сценарию.


			Параметры атрибута:


				- Идентификатор атрибута: BY_SC;


				- Тип данных: Целый.


			 Окончание расчета


			 Признак того, что выполнение правила валидации окончено.
			 Допустимые значения:


				- 0. Правило
				 валидации еще выполняется;


				- 1. Правило
				 валидации уже выполнено.


			Параметры атрибута:


				- Идентификатор атрибута: FNSH;


				- Тип данных: Логический.


### Структура метасправочника исключений, выявленных правилами валидации


	Метасправочник исключений, выявленных правилами валидации, содержит
	 данные о наблюдениях временных рядов, которые были исключены правилами
	 валидации, выполненными в базе данных временных рядов.


	Наименование метасправочника формируется по следующей схеме: Значения правил_<наименование базы
	 данных временных рядов>. Например, в базе данных временных
	 рядов «Статистика» метасправочник
	 ревизий будет иметь наименование «Значения
	 правил_Статистика».


			 Наименование атрибута
			 Описание


			 Ключ


			 Первичный ключ.


			Параметры атрибута:


				- Идентификатор атрибута: KEY;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Факт


			 Ключ временного ряда, которому принадлежит наблюдение.


			Параметры атрибута:


				- Идентификатор атрибута: FACTOR;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Динамика


			 Календарная динамика наблюдения. Для определения динамики
			 используется перечисление [DimCalendarLevel](KeDims.chm::/Enums/DimCalendarLevel.htm).


			Параметры атрибута:


				- Идентификатор атрибута: DL;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


			 Дата


			 Дата наблюдения.


			Параметры атрибута:


				- Идентификатор атрибута: DT;


				- Тип данных: Дата.


			 Правило


			 Ключ выполнения правила валидации.


			По нему можно найти соответствующую запись в метасправочнике
			 выполнения правил валидации.


			Параметры атрибута:


				- Идентификатор атрибута: CMT;


				- Тип данных: Целый.


			 Значение


			 Признак того, что в матрице исключений валидации присутствует
			 значение. Атрибут имеет значение «1», если исключение объяснено,
			 и пустое значение, если исключение не объяснено.


			Параметры атрибута:


				- Идентификатор атрибута: VL;


				- Тип данных: Целый.


			 Сценарий


			 Ключ сценария, которому принадлежит наблюдение. Если
			 значение «-1», то наблюдение принадлежит сценарию «Факт».


			Примечание.
			 Атрибут отсутствует, если база данных временных рядов не поддерживает
			 сценарии. Для получения подробной информации обратитесь к
			 описанию свойства [IRubricator.HasScenarioDimension](kecubes.chm::/Interface/IRubricator/IRubricator.HasScenarioDimension.htm).


			Параметры атрибута:


				- Идентификатор атрибута: SC;


				- Тип данных: Целый;


				- Особенности атрибута: Пустые значения не допускаются.


См. также:


[База знаний разработчиков](../KnowledgeBase_Intro.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
