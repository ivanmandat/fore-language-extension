# ForeExec: Операция

ForeExec: Операция
-


# ForeExec


## Синтаксис


ForeExecResult ForeExec(ForeId tFore, ForeExecArg
 tArg)


## Параметры


tFore. Моникёр объекта среды
 разработки, содержащего реализацию выполняемого метода.


tArg. Параметры выполнения
 операции.


## Описание


Операция ForeExec выполняет
 методы, реализованные в Fore-модулях.


## Комментарии


Для выполнения операции необходимо в поле tFore
 указать моникёр модуля/сборки, содержащего реализацию выполняемого метода.
 Моникёр может быть получен при выполнении операции [GetObjects](GetObjects.htm).
 В поле tArg.methodName укажите
 наименование выполняемого метода, а в поле tArg.args
 значения входных параметров метода. Реализация метода должна располагаться
 в глобальном пространстве имен.


Сигнатура выполняемого метода может содержать параметры простых типов
 и возвращать значение простого типа. Если метод возвращает какое-либо
 значение, то оно будет доступно в результате выполнения операции.


Если выполняемый метод содержит параметры с типом Object,
 то в качестве значения этих параметров должны передаваться строковые представления
 моникёров каких-либо объектов. При выполнении операции по моникёру будет
 получен и передан в выполняемый метод соответствующий объект репозитория.
 Для работы с этим объектом приведите его к интерфейсу, который описывает
 его структуру. Например, при передаче моникёра соединения с репозиторием
 параметр в методе будет иметь тип [IMetabase](KeSom.chm::/Interface/IMetabase/IMetabase.htm),
 при передаче моникёра экспресс-отчета - [IEaxAnalyzer](KeExpress.chm::/Interface/IEaxAnalyzer/IEaxAnalyzer.htm) и так
 далее.


Если передаётся моникёр бинарного объекта, сохранённого на сервере с
 помощью операции [PutBin](../../Additional/PutBin.htm),
 то в выполняемом методе такой объект может быть приведён к интерфейсу
 [IBinary](ModDrawing.chm::/Interface/IBinary/IBinary.htm).


Операция ForeExec может передавать в выполняемый метод объекты в JSON-формате,
 а также принимать ответ в JSON-формате. Соответствующие параметры в сигнатуре
 метода должны иметь тип [IJsonObject](ForeSys.chm::/Interface/IJsonObject/IJsonObject.htm).
 Возвращаемый тип значения также должен быть [IJsonObject](ForeSys.chm::/Interface/IJsonObject/IJsonObject.htm).


## Рекомендации по использованию


При разработке веб-приложения, из которого предполагается запуск на
 выполнение различных методов, используйте следующие рекомендации:


	- Используйте ForeExec
	 для выполнения кода, который осуществляет простые вычисления или операции,
	 не требующие затраты большого количества ресурсов и времени;


	- Если в коде выполняются ресурсоёмкие действия (вычисление отчетов,
	 загрузка/преобразование больших объемов данных и другое), то рекомендуется
	 рассмотреть возможность использования контейнера запланированных задач
	 - создать задачу выполнения модуля и для управления задачей использовать
	 [операции](../TaskContainer/TaskContainer_List.htm) для
	 работы с контейнером запланированных задач;


	- При выборе конфигурации BI-сервера необходимо учитывать количество
	 возможных ресурсоёмких действий, которые потребуется выполнить с помощью
	 ForeExec параллельно. Количество
	 ядер процессора (физических и логических) должно быть не меньше, чем
	 количество возможных ресурсоёмких действий, запускаемых на выполнение
	 в одном потоке.


## Запрет выполнения операции ForeExec


Ввиду возможного использования операции ForeExec
 для выполнения кода, к которому конкретный пользователь не должен иметь
 доступа, существует ряд возможностей запрета выполнения операции:


	- Создание параметра Disallow
	 со значением «1» в файле настроек
	 BI-сервера [settings.xml](Setup.chm::/UiWebSetup/03_Setup_Web/BI_Server_Settings_XML.htm).
	 Разрешение/запрет операции будет осуществляться BI-сервером.


	- Создание параметра foreExec
	 со значением False в файле
	 конфигурации веб-приложения [PP.xml](Setup.chm::/UiWebSetup/03_Setup_Web/PP_config_Java.htm).
	 Разрешение/запрет операции будет осуществляться веб-сервером, на котором
	 установлена серверная часть веб-приложения. При этом для запрета операции
	 в заголовке запроса будет автоматически формироваться параметр «p_h» со значением «1».


Примечание.
 Более подробно о месте расположения параметров читайте в описании соответствующих
 файлов конфигурации.


	- В заголовке запроса, выполняющего операцию ForeExec,
	 сформировать параметр «p_h»
	 или «p-h» со значением «1». Формирование параметра производится
	 с использованием ресурсов того языка программирования, на котором
	 ведется разработка в соответствии с прикладной логикой приложения.
	 Например, при разработке на JavaScript
	 код будет следующим:


<html>
<body>
    <script language="javascript" type="text/javascript">
    <!--...Предыдущий код приложения...-->
    <!--...-->
    <!--Функция для отправки JSON-запроса-->
    function PostRequest(url, request) {
        <!--...-->
        var xhr = new XMLHttpRequest();
        <!--...-->
        xhr.setRequestHeader('p-h', '1');
        <!--...-->
        xhr.send(JSON.stringify(request));
        <!--...-->
    }
    </script>
</body>
</html>

## Особенности работы


При работе операции ForeExec не проверяется время изменения модулей/сборок,
 поэтому при первом выполнении метода в кеш сборок будет загружена текущая
 версия объекта из репозитория. Если в дальнейшем код метода изменяется,
 то его повторный запуск с помощью операции ForeExec приведёт к выполнению
 старой версии метода, которая уже имеется в кеше сборок. Для использования
 актуальной версии метода потребуется перезагрузка BI-сервера.


## Пример


Различные варианты использования операции приведены в следующих примерах:


		 Наименование примера


		 [Выполнение
		 Fore-метода](ForeExec_Sample/ForeExec_ForeMethod.htm)


		 [Передача
		 объектов в качестве значений параметров](ForeExec_Sample/Object_In_Params.htm)


		 [Работа
		 с объектами в JSON-формате](ForeExec_Sample/ForeExec_And_Json.htm)


См. также:


[Специфические
 операции](Specific_List.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
