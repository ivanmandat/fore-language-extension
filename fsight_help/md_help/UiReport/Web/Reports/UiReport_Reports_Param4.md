# Настройка формул отчёта: Регламентный отчёт, веб-приложение

Настройка формул отчёта: Регламентный отчёт, веб-приложение
-


# Настройка формул отчёта


Для определения параметров расчета [формул](../organizational_management/Function/UiReport_Function.htm)
 с циклическими ссылками и стиля ссылок используйте группу настроек «Формулы» панели «Настройки».


[![](../../opened.gif)![](../../closed.gif)Для вызова панели
 «Настройки»](javascript:TextPopup(this))


	Выполните команду главного меню «Настройки».


![](formula.png)


Открыть вкладку «Формулы» панели
 «Параметры» также можно посредством
 вызова команды «Параметры проверки ошибок»
 в контекстном меню ячейки с ошибкой.


Определите на вкладке следующие настройки:


	- основные: [итеративные
	 вычисления](UiReport_Reports_Param4.htm#specific) и [стиль
	 ссылок](UiReport_Reports_Param4.htm#r1c1);


	- ошибки: [индикация
	 ошибок](UiReport_Reports_Param4.htm#error_checking), [пропущенные
	 ошибки](UiReport_Reports_Param4.htm#reset) и [правила поиска
	 ошибок](UiReport_Reports_Param4.htm#rules).


[![](../../opened.gif)![](../../closed.gif)Итеративные
 вычисления](javascript:TextPopup(this))


	При установленном флажке «Итеративные
	 вычисления» появляется возможность вычислять содержимое ячеек,
	 содержащих формулы с циклическими ссылками.


	Примечание.
	 Данная настройка задается для всего отчёта, но разрешение циклических
	 ссылок ведется в рамках одного листа. Например, если в ячейках указаны
	 циклические формулы, ссылающиеся на значения ячеек других листов,
	 то даже при включении итеративного режима будет отображена ошибка
	 «Обнаружены циклические ссылки».


	По умолчанию флажок снят и данные ячеек, содержащих циклические
	 ссылки, не вычисляются, в таких ячейках будет отображена ошибка. При
	 установке флажка происходит автоматическое перевычисление формул.
	 При смене параметров итеративного расчёта автоматического перевычисления
	 формул не происходит.


	Если при добавлении формулы в ячейку появляется цикл и включено
	 итеративное вычисление циклических ссылок, то начальное значение этой
	 ячейки считается равным нулю. При включённом режиме при каждом вычислении
	 отчёта будет производиться выполнение цикла с заданными параметрами.
	 Цикл заканчивается при достижении предельного числа итераций или когда
	 изменение значения величины каждой ячейки становится меньше относительной
	 погрешности.


	После установки флажка «Итеративные
	 вычисления» задайте параметры:


		- Предельное число итераций.
		 Задайте количество итераций, после которых прекратится расчёт
		 ячеек с циклическими ссылками. По умолчанию установлено значение
		 в 100 итераций;


		- Относительная погрешность.
		 Задайте величину, с которой будет сравниваться разница значений
		 каждой ячейки с циклическими ссылками в текущей и предыдущей итерациях.
		 Если изменение значения величины каждой ячейки становится меньше
		 относительной погрешности, то на данной итерации расчет ячеек
		 с циклическими ссылками прекращается. По умолчанию в качестве
		 значения относительной погрешности задано «0,001».


	Примечание.
	 Значения параметров «Предельное число
	 итераций» и «Относительная
	 погрешность» должны быть неотрицательными числами.


[![](../../opened.gif)![](../../closed.gif)Стиль
 ссылок R1C1](javascript:TextPopup(this))


	В регламентных отчётах доступно использование двух стилей ссылок:


		- А1. Столбцы обозначаются
		 буквами, а строки - цифрами;


		- R1C1. Строки (R
		 - row) и столбцы (C - column) обозначаются цифрами и ссылки на
		 ячейки в формулах задаются при помощи смещения от текущей ячейки.
		 Например, ссылка R[-1]C[2] ссылается на ячейку, которая находится
		 на одну строку выше и на два столбца правее текущей ячейки.


	По умолчанию флажок «Стиль ссылок
	 R1C1» снят, при этом используется стиль ссылок А1.
	 При установленном флажке для формирования новых ссылок будет использоваться
	 стиль R1C1, при этом заголовки
	 колонок в листе будут иметь цифровое обозначение.


[![](../../opened.gif)![](../../closed.gif)Индикация
 ошибок](javascript:TextPopup(this))


	Установите флажок «Индикация ошибок»
	 для настройки подсветки при возникновении ошибок. В раскрывающейся
	 палитре «Цвет индикаторов ошибок»
	 выберите цвет для подсветки ячеек.


[![](../../opened.gif)![](../../closed.gif)Пропущенные
 ошибки](javascript:TextPopup(this))


	Настройка доступна, если был установлен флажок «[Индикация ошибок](UiReport_Reports_Param4.htm#error_checking)».


	Нажмите кнопку «Сбросить ошибки»
	 для возврата индикации тем ячейкам, которые содержали ошибки в формулах,
	 но были пропущены пользователем при помощи команды «[Пропустить ошибку](UiReport_Reports_Param4.htm#rules)».


[![](../../opened.gif)![](../../closed.gif)Правила
 поиска ошибок](javascript:TextPopup(this))


	Для задания дополнительных правил поиска и проверки ошибок определите
	 параметры в группе «Правила поиска
	 ошибок»:


		- Проверять ссылки на пустые
		 ячейки. При установленном флажке будет осуществлена проверка
		 ссылок на пустые ячейки;


	Примечание.
	 При работе с пустыми ячейками учитывайте особенности вычисления некоторых
	 функций: [Average](../organizational_management/Function/Math/UiReport_Func_Math_Average.htm),
	 [Max](../organizational_management/Function/Math/UiReport_Func_Math_Max.htm)
	 и [Min](../organizational_management/Function/Math/UiReport_Func_Math_Min.htm).


		- Числа, отформатированные
		 как текст. При установленном флажке в соответствующих ячейках
		 будет отображаться индикатор ошибки и контекстная кнопка для [управления
		 ошибкой](../organizational_management/Function/UiReport_Function.htm#cell_indication). Установите флажок для индикации ячеек с числами,
		 сохранёнными в текстовом формате;


		- Если формула ссылается
		 на пустую ячейку. В раскрывающемся списке выберите одно
		 из действий для проверки формул, ссылающихся на пустые ячейки:


			- Показывать индикатор
			 ошибки. По умолчанию пустые ячейки, которые используются
			 в формуле, заменяются нулями. В ячейке будет отображаться
			 результат расчёта формулы, индикатор ошибки и контекстная
			 кнопка ![](error.png)
			 «Действия над ошибкой»
			 для [управления
			 ошибкой](../organizational_management/Function/UiReport_Function.htm#cell_indication) в формуле при нажатии на ячейку:


				- ![](b_number_transform.png)
				 Преобразовать в число. Команда выполняет преобразование
				 значения, содержащегося в ячейке, в числовой формат данных.
				 Команда доступна для диапазона ячеек, содержащих подобные
				 данные;


	Примечание.
	 Данная команда доступна только для ячеек с числами, сохранёнными в
	 текстовом формате.


				- ![](b_miss.png)
				 Пропустить ошибку. Команда закрывает контекстное
				 меню, снимает индикатор ошибки с ячейки и скрывает кнопку
				 ошибки;


				- ![](OperationReport/b_edit.png)
				 Изменить в строке формул. Команда переводит ячейку
				 в режим редактирования формулы. Фокус ввода при этом смещается
				 в строку формул. Если строка формул выключена, то
				 она появляется и в главном меню «Вид
				 > Показать» устанавливается соответствующий
				 флажок;


				- ![](b_params.png)
				 Параметры проверки ошибок. Команда открывает панель
				 «Параметры» на
				 вкладке «Формулы»;


	Примечание.
	 Для диапазона ячеек доступна только команда «Пропустить
	 ошибку».


			- Не вычислять формулу.
			 В ячейке будет выводиться сообщение об ошибке «#ССЫЛКА!» без
			 отображения индикатора;


			- Считать пустое значение
			 нулём. Пустое значение будет заменено нулём.


См. также:


[Использование
 формул](../organizational_management/Function/UiReport_Function.htm)


		Справочная
		 система на версию 10.9
		 от 18/08/2025,
		 © ООО «ФОРСАЙТ»,
